package com.softwareverde.bitcoin.transaction.validator;

import com.softwareverde.bitcoin.CoreInflater;
import com.softwareverde.bitcoin.bip.ChipNetUpgradeSchedule;
import com.softwareverde.bitcoin.bip.CoreUpgradeSchedule;
import com.softwareverde.bitcoin.bip.TestNet4UpgradeSchedule;
import com.softwareverde.bitcoin.bip.TestNetUpgradeSchedule;
import com.softwareverde.bitcoin.bip.UpgradeSchedule;
import com.softwareverde.bitcoin.chain.time.ImmutableMedianBlockTime;
import com.softwareverde.bitcoin.chain.time.MedianBlockTime;
import com.softwareverde.bitcoin.inflater.MasterInflater;
import com.softwareverde.bitcoin.test.UnitTest;
import com.softwareverde.bitcoin.test.fake.FakeMedianBlockTimeContext;
import com.softwareverde.bitcoin.test.fake.FakeUnspentTransactionOutputContext;
import com.softwareverde.bitcoin.test.fake.FakeUpgradeSchedule;
import com.softwareverde.bitcoin.test.fake.VolatileNetworkTimeWrapper;
import com.softwareverde.bitcoin.test.util.TransactionTestUtil;
import com.softwareverde.bitcoin.transaction.Transaction;
import com.softwareverde.bitcoin.transaction.TransactionDeflater;
import com.softwareverde.bitcoin.transaction.TransactionInflater;
import com.softwareverde.bitcoin.transaction.input.TransactionInput;
import com.softwareverde.bitcoin.transaction.input.TransactionInputInflater;
import com.softwareverde.bitcoin.transaction.output.TransactionOutput;
import com.softwareverde.bitcoin.transaction.output.TransactionOutputInflater;
import com.softwareverde.bitcoin.transaction.script.ScriptDeflater;
import com.softwareverde.bitcoin.transaction.script.locking.ImmutableLockingScript;
import com.softwareverde.bitcoin.transaction.script.locking.LockingScript;
import com.softwareverde.bitcoin.transaction.script.runner.ScriptRunner;
import com.softwareverde.bitcoin.transaction.script.runner.context.MutableTransactionContext;
import com.softwareverde.bitcoin.transaction.script.runner.context.TransactionContext;
import com.softwareverde.bitcoin.transaction.script.unlocking.ImmutableUnlockingScript;
import com.softwareverde.bitcoin.transaction.script.unlocking.UnlockingScript;
import com.softwareverde.constable.bytearray.ByteArray;
import com.softwareverde.constable.bytearray.MutableByteArray;
import com.softwareverde.constable.list.List;
import com.softwareverde.constable.list.mutable.MutableArrayList;
import com.softwareverde.constable.list.mutable.MutableList;
import com.softwareverde.constable.map.Map;
import com.softwareverde.cryptography.hash.sha256.Sha256Hash;
import com.softwareverde.json.Json;
import com.softwareverde.logging.Logger;
import com.softwareverde.network.time.ImmutableNetworkTime;
import com.softwareverde.network.time.VolatileNetworkTime;
import com.softwareverde.util.HexUtil;
import org.junit.After;
import org.junit.Assert;
import org.junit.Test;



public class HistoricTransactionsTests extends UnitTest {
    public static class TestConfig {
        String transactionBytes;
        String transactionInputBytes;
        Integer transactionOutputIndex;
        String transactionOutputBytes;
        Long blockHeight;
        Integer transactionInputIndex;
        String lockingScriptBytes;
        String unlockingScriptBytes;
        Long medianBlockTime;
    }

    public static Json toBitcoinjTestCase(final TestConfig testConfig, final UpgradeSchedule upgradeSchedule) {
        final TransactionContext transactionContext = HistoricTransactionsTests.initContext(testConfig, (Map<Sha256Hash, Transaction>) null, upgradeSchedule);
        return HistoricTransactionsTests.toBitcoinjTestCase(transactionContext);
    }

    public static Json toBitcoinjTestCase(final TransactionContext transactionContext) {
        // ["[[[prevout hash, prevout index, prevout scriptPubKey], [input 2], ...],"], ["serializedTransaction, verifyFlags]"],
        final Json json = new Json(true);

        { // Transaction Output...
            final Json transactionInputsJson = new Json(true);

            final TransactionInput transactionInput = transactionContext.getTransactionInput();
            final TransactionOutput transactionOutput = transactionContext.getTransactionOutputBeingSpent();
            final LockingScript lockingScript = transactionOutput.getLockingScript();
            final String lockingScriptString = (new ScriptDeflater()).toStandardString(lockingScript);

            final Json txInputJson = new Json(true);
            txInputJson.add(transactionInput.getPreviousOutputTransactionHash());
            txInputJson.add(transactionInput.getPreviousOutputIndex());
            txInputJson.add(lockingScriptString);
            transactionInputsJson.add(txInputJson);

            json.add(Json.parse(transactionInputsJson.toString().toLowerCase()));
        }

        { // Transaction Data...
            final Transaction transaction = transactionContext.getTransaction();
            final ByteArray transactionBytes = (new TransactionDeflater()).toBytes(transaction);
            json.add(transactionBytes);
        }

        { // Validation Flags...
            json.add("P2SH");
        }

        return json;
    }

    public static TransactionContext initContext(final TestConfig testConfig, final Map<Sha256Hash, Transaction> transactionsToSpend, final UpgradeSchedule upgradeSchedule) {
        final TransactionInflater transactionInflater = new TransactionInflater();
        final Transaction transaction = transactionInflater.fromBytes(HexUtil.hexStringToByteArray(testConfig.transactionBytes));

        final int transactionInputCount;
        {
            final List<TransactionInput> transactionInputs = transaction.getTransactionInputs();
            transactionInputCount = transactionInputs.getCount();
        }

        final List<TransactionOutput> outputsToSpend;
        if (transactionsToSpend != null) {
            final List<TransactionInput> transactionInputs = transaction.getTransactionInputs();
            outputsToSpend = TransactionTestUtil.createPreviousTransactionOutputsList(transactionInputs, transactionsToSpend);
        }
        else {
            final TransactionOutput transactionOutput;
            {
                if (testConfig.transactionOutputBytes != null) {
                    final TransactionOutputInflater transactionOutputInflater = new TransactionOutputInflater();
                    transactionOutput = transactionOutputInflater.fromBytes(testConfig.transactionOutputIndex, HexUtil.hexStringToByteArray(testConfig.transactionOutputBytes));
                }
                else {
                    transactionOutput = null;
                }
            }

            outputsToSpend = TransactionTestUtil.createPreviousTransactionOutputsList(transactionInputCount, testConfig.transactionInputIndex, transactionOutput);
        }

        return HistoricTransactionsTests.initContext(testConfig, outputsToSpend, upgradeSchedule);
    }

    public static TransactionContext initContext(final TestConfig testConfig, final List<TransactionOutput> transactionOutputsToSpend, final UpgradeSchedule upgradeSchedule) {
        final TransactionInflater transactionInflater = new TransactionInflater();
        final Transaction transaction = transactionInflater.fromBytes(HexUtil.hexStringToByteArray(testConfig.transactionBytes));

        final int transactionInputCount;
        {
            final List<TransactionInput> transactionInputs = transaction.getTransactionInputs();
            transactionInputCount = transactionInputs.getCount();
        }

        final TransactionInput transactionInput;
        {
            if (testConfig.transactionInputBytes != null) {
                final TransactionInputInflater transactionInputInflater = new TransactionInputInflater();
                transactionInput = transactionInputInflater.fromBytes(HexUtil.hexStringToByteArray(testConfig.transactionInputBytes));
            }
            else {
                transactionInput = null;
            }
        }

        final TransactionOutput transactionOutput;
        {
            if (testConfig.transactionOutputBytes != null) {
                final TransactionOutputInflater transactionOutputInflater = new TransactionOutputInflater();
                transactionOutput = transactionOutputInflater.fromBytes(testConfig.transactionOutputIndex, HexUtil.hexStringToByteArray(testConfig.transactionOutputBytes));
            }
            else {
                transactionOutput = null;
            }
        }

        final MutableTransactionContext context = new MutableTransactionContext(upgradeSchedule);
        {
            context.setBlockHeight(testConfig.blockHeight);
            context.setTransaction(transaction);
            if (testConfig.medianBlockTime != null) {
                final MedianBlockTime medianBlockTime = MedianBlockTime.fromSeconds(testConfig.medianBlockTime);
                context.setMedianBlockTime(medianBlockTime);
            }

            context.setTransactionInput(transactionInput);
            if (transactionOutputsToSpend != null) {
                context.setPreviousTransactionOutputs(transactionOutputsToSpend);
            }
            else {
                context.setPreviousTransactionOutputs(TransactionTestUtil.createPreviousTransactionOutputsList(transactionInputCount, testConfig.transactionInputIndex, transactionOutput));
            }
            context.setTransactionInputIndex(testConfig.transactionInputIndex);
        }

        return context;
    }

    public static void runScripts(final TestConfig testConfig) {
        final UpgradeSchedule upgradeSchedule = new FakeUpgradeSchedule(new CoreUpgradeSchedule());
        HistoricTransactionsTests.runScripts(testConfig, upgradeSchedule, true);
    }

    public static void runScripts(final TestConfig testConfig, final Boolean expectedResult) {
        final UpgradeSchedule upgradeSchedule = new FakeUpgradeSchedule(new CoreUpgradeSchedule());
        HistoricTransactionsTests.runScripts(testConfig, upgradeSchedule, expectedResult);
    }

    public static void runScripts(final TestConfig testConfig, final UpgradeSchedule upgradeSchedule) {
        HistoricTransactionsTests.runScripts(testConfig, upgradeSchedule, true);
    }

    public static void runScripts(final TestConfig testConfig, final UpgradeSchedule upgradeSchedule, final Boolean expectedResult) {
        // Setup
        final TransactionContext transactionContext = HistoricTransactionsTests.initContext(testConfig, (Map<Sha256Hash, Transaction>) null, upgradeSchedule);

        final LockingScript lockingScript = new ImmutableLockingScript(MutableByteArray.wrap(HexUtil.hexStringToByteArray(testConfig.lockingScriptBytes)));
        final UnlockingScript unlockingScript = new ImmutableUnlockingScript(MutableByteArray.wrap(HexUtil.hexStringToByteArray(testConfig.unlockingScriptBytes)));

        final ScriptRunner scriptRunner = new ScriptRunner(upgradeSchedule);

        // Action
        final Boolean inputIsUnlocked = scriptRunner.runScript(lockingScript, unlockingScript, transactionContext).isValid;

        // Assert
        Assert.assertEquals(expectedResult, inputIsUnlocked);
    }

    public static Boolean runScripts(final TestConfig testConfig, final Map<Sha256Hash, Transaction> transactionsToSpend, final UpgradeSchedule upgradeSchedule) {
        final TransactionContext transactionContext = HistoricTransactionsTests.initContext(testConfig, transactionsToSpend, upgradeSchedule);

        final LockingScript lockingScript = new ImmutableLockingScript(MutableByteArray.wrap(HexUtil.hexStringToByteArray(testConfig.lockingScriptBytes)));
        final UnlockingScript unlockingScript = new ImmutableUnlockingScript(MutableByteArray.wrap(HexUtil.hexStringToByteArray(testConfig.unlockingScriptBytes)));

        final ScriptRunner scriptRunner = new ScriptRunner(upgradeSchedule);

        return scriptRunner.runScript(lockingScript, unlockingScript, transactionContext).isValid;
    }

    public static Boolean runScripts(final TestConfig testConfig, final List<TransactionOutput> outputsToSpend, final UpgradeSchedule upgradeSchedule) {
        final TransactionContext transactionContext = HistoricTransactionsTests.initContext(testConfig, outputsToSpend, upgradeSchedule);

        final LockingScript lockingScript = new ImmutableLockingScript(MutableByteArray.wrap(HexUtil.hexStringToByteArray(testConfig.lockingScriptBytes)));
        final UnlockingScript unlockingScript = new ImmutableUnlockingScript(MutableByteArray.wrap(HexUtil.hexStringToByteArray(testConfig.unlockingScriptBytes)));

        final ScriptRunner scriptRunner = new ScriptRunner(upgradeSchedule);

        return scriptRunner.runScript(lockingScript, unlockingScript, transactionContext).isValid;
    }

    @After
    public void shutdown() {
        Logger.flush();
    }

    @Test
    public void should_verify_multisig_transaction_EB3B82C0884E3EFA6D8B0BE55B4915EB20BE124C9766245BCC7F34FDAC32BCCB_1() {
        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "01000000024DE8B0C4C2582DB95FA6B3567A989B664484C7AD6672C85A3DA413773E63FDB8000000006B48304502205B282FBC9B064F3BC823A23EDCC0048CBB174754E7AA742E3C9F483EBE02911C022100E4B0B3A117D36CAB5A67404DDDBF43DB7BEA3C1530E0FE128EBC15621BD69A3B0121035AA98D5F77CD9A2D88710E6FC66212AFF820026F0DAD8F32D1F7CE87457DDE50FFFFFFFF4DE8B0C4C2582DB95FA6B3567A989B664484C7AD6672C85A3DA413773E63FDB8010000006F004730440220276D6DAD3DEFA37B5F81ADD3992D510D2F44A317FD85E04F93A1E2DAEA64660202200F862A0DA684249322CEB8ED842FB8C859C0CB94C81E1C5308B4868157A428EE01AB51210232ABDC893E7F0631364D7FD01CB33D24DA45329A00357B3A7886211AB414D55A51AEFFFFFFFF02E0FD1C00000000001976A914380CB3C594DE4E7E9B8E18DB182987BEBB5A4F7088ACC0C62D000000000017142A9BC5447D664C1D0141392A842D23DBA45C4F13B17500000000";
        testConfig.transactionInputBytes = "4DE8B0C4C2582DB95FA6B3567A989B664484C7AD6672C85A3DA413773E63FDB8010000006F004730440220276D6DAD3DEFA37B5F81ADD3992D510D2F44A317FD85E04F93A1E2DAEA64660202200F862A0DA684249322CEB8ED842FB8C859C0CB94C81E1C5308B4868157A428EE01AB51210232ABDC893E7F0631364D7FD01CB33D24DA45329A00357B3A7886211AB414D55A51AEFFFFFFFF";
        testConfig.transactionOutputIndex = 1;
        testConfig.transactionOutputBytes = "C0C62D000000000017142A9BC5447D664C1D0141392A842D23DBA45C4F13B175";
        testConfig.blockHeight = 163685L;
        testConfig.transactionInputIndex = 1;
        testConfig.lockingScriptBytes = "142A9BC5447D664C1D0141392A842D23DBA45C4F13B175";
        testConfig.unlockingScriptBytes = "004730440220276D6DAD3DEFA37B5F81ADD3992D510D2F44A317FD85E04F93A1E2DAEA64660202200F862A0DA684249322CEB8ED842FB8C859C0CB94C81E1C5308B4868157A428EE01AB51210232ABDC893E7F0631364D7FD01CB33D24DA45329A00357B3A7886211AB414D55A51AE";

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_SIGHASHNONE_transaction_599E47A8114FE098103663029548811D2651991B62397E057F0C863C2BC9F9EA_1() {
        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "01000000015F386C8A3842C9A9DCFA9B78BE785A40A7BDA08B64646BE3654301EACCFC8D5E010000008A4730440220BB4FBC495AA23BABB2C2BE4E3FB4A5DFFEFE20C8EFF5940F135649C3EA96444A022004AFCDA966C807BB97622D3EEFEA828F623AF306EF2B756782EE6F8A22A959A2024104F1939AE6B01E849BF05D0ED51FD5B92B79A0E313E3F389C726F11FA3E144D9227B07E8A87C0EE36372E967E090D11B777707AA73EFACABFFFFA285C00B3622D6FFFFFFFF0240420F00000000001976A914660D4EF3A743E3E696AD990364E555C271AD504B88AC2072C801000000001976A91421C43CE400901312A603E4207AADFD742BE8E7DA88AC00000000";
        testConfig.transactionInputBytes = "5F386C8A3842C9A9DCFA9B78BE785A40A7BDA08B64646BE3654301EACCFC8D5E010000008A4730440220BB4FBC495AA23BABB2C2BE4E3FB4A5DFFEFE20C8EFF5940F135649C3EA96444A022004AFCDA966C807BB97622D3EEFEA828F623AF306EF2B756782EE6F8A22A959A2024104F1939AE6B01E849BF05D0ED51FD5B92B79A0E313E3F389C726F11FA3E144D9227B07E8A87C0EE36372E967E090D11B777707AA73EFACABFFFFA285C00B3622D6FFFFFFFF";
        testConfig.transactionOutputIndex = 1;
        testConfig.transactionOutputBytes = "60B4D701000000001976A91421C43CE400901312A603E4207AADFD742BE8E7DA88AC";
        testConfig.blockHeight = 178627L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "76A91421C43CE400901312A603E4207AADFD742BE8E7DA88AC";
        testConfig.unlockingScriptBytes = "4730440220BB4FBC495AA23BABB2C2BE4E3FB4A5DFFEFE20C8EFF5940F135649C3EA96444A022004AFCDA966C807BB97622D3EEFEA828F623AF306EF2B756782EE6F8A22A959A2024104F1939AE6B01E849BF05D0ED51FD5B92B79A0E313E3F389C726F11FA3E144D9227B07E8A87C0EE36372E967E090D11B777707AA73EFACABFFFFA285C00B3622D6";

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_pay_to_script_hash_transaction_6A26D2ECB67F27D1FA5524763B49029D7106E91E3CC05743073461A719776192_1() {
        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "0100000001F6EA284EC7521F8A7D094A6CF4E6873098B90F90725FFD372B343189D7A4089C0100000026255121029B6D2C97B8B7C718C325D7BE3AC30F7C9D67651BCE0C929F55EE77CE58EFCF8451AEFFFFFFFF0130570500000000001976A9145A3ACBC7BBCC97C5FF16F5909C9D7D3FADB293A888AC00000000";
        testConfig.transactionInputBytes = "F6EA284EC7521F8A7D094A6CF4E6873098B90F90725FFD372B343189D7A4089C0100000026255121029B6D2C97B8B7C718C325D7BE3AC30F7C9D67651BCE0C929F55EE77CE58EFCF8451AEFFFFFFFF";
        testConfig.transactionOutputIndex = 1;
        testConfig.transactionOutputBytes = "801A06000000000017A91419A7D869032368FD1F1E26E5E73A4AD0E474960E87";
        testConfig.blockHeight = 170095L; // NOTE: P2SH was not activated until Block 173805...
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A91419A7D869032368FD1F1E26E5E73A4AD0E474960E87";
        testConfig.unlockingScriptBytes = "255121029B6D2C97B8B7C718C325D7BE3AC30F7C9D67651BCE0C929F55EE77CE58EFCF8451AE";

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_pay_to_script_hash_transaction_1CC1ECDF5C05765DF3D1F59FBA24CD01C45464C329B0F0A25AA9883ADFCF7F29_1() {
        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "01000000014ACC6214C74AF23AE430AFF165004D8E10DB9860B87FFB7E7E703AF97B872203010000009200483045022100BEB926DA7428FA009AC770576342EBD1960939E73584A5D0F3229B58C41E906F022017C0D143077906AFCCF30CAF21F5ECE0BB30E3F708FD4A17F9D9EF9FE7CDC983014751210307AC6296168948C3F64CE22F51F6E5424F936C846F1D01223B3D9864F4D955662103AC6AD514715BEC8D5DE1873B9BC873BB71773B51338B4D115F9938B6A029B7D152AEFFFFFFFF02C0175302000000001976A9146723D3398B384F0C0A8F717C100905F36E2ED7D488AC80969800000000001976A9148A033817801503863C9D6BD124D153F8407F2B4188AC00000000";
        testConfig.transactionInputBytes = "4ACC6214C74AF23AE430AFF165004D8E10DB9860B87FFB7E7E703AF97B872203010000009200483045022100BEB926DA7428FA009AC770576342EBD1960939E73584A5D0F3229B58C41E906F022017C0D143077906AFCCF30CAF21F5ECE0BB30E3F708FD4A17F9D9EF9FE7CDC983014751210307AC6296168948C3F64CE22F51F6E5424F936C846F1D01223B3D9864F4D955662103AC6AD514715BEC8D5DE1873B9BC873BB71773B51338B4D115F9938B6A029B7D152AEFFFFFFFF";
        testConfig.transactionOutputIndex = 1;
        testConfig.transactionOutputBytes = "80F0FA020000000017A9145C02C49641699863F909BF4BF3BE8398D2E383F187";
        testConfig.blockHeight = 177644L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A9145C02C49641699863F909BF4BF3BE8398D2E383F187";
        testConfig.unlockingScriptBytes = "00483045022100BEB926DA7428FA009AC770576342EBD1960939E73584A5D0F3229B58C41E906F022017C0D143077906AFCCF30CAF21F5ECE0BB30E3F708FD4A17F9D9EF9FE7CDC983014751210307AC6296168948C3F64CE22F51F6E5424F936C846F1D01223B3D9864F4D955662103AC6AD514715BEC8D5DE1873B9BC873BB71773B51338B4D115F9938B6A029B7D152AE";

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_pay_to_script_hash_transaction_968A692AB98B1F275C635C76BE003AB1DB9740D0B62F338B270115342CA42F5B_1() {
        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "010000000120DA26875149D4F80F3C36ABC7F984720ED14F6396854AD1ABCA4FE72C88DC4F00000000FDFD0000483045022100939D7023833AAFFCB0DC2E6A0065316B90B7987BF3F4D99C5BC8811811782F34022064B5C3EF966E3312D615A06A3119D7599F12621BB92AC5CF1D971EF1AD9C8A65014730440220394151FB40EDD54326FA829EC571165A5E9168484293FD77E3713A35A701B43B02206B0FFF8488597790E2F6D62847CDE16DE3234439800F019423E7BEF881311862014C695221032C6AA78662CC43A3BB0F8F850D0C45E18D0A49C61EC69DB87E072C88D7A9B6E9210353581FD2FC745D17264AF8CB8CD507D82C9658962567218965E750590E41C41E21024FE45DD4749347D281FD5348F56E883EE3A00903AF899301AC47BA90F904854F53AEFFFFFFFF0330C11D00000000001976A914FD5E323C595B2614F47D6BE25BA079F081628C9B88AC80969800000000001976A91406F1B67078FC400A63D54C313CD6BB817E4760F088AC40787D01000000001976A9140231C76FF14600B49F7C1B734A69F169C7BA1BAC88AC00000000";
        testConfig.transactionInputBytes = "20DA26875149D4F80F3C36ABC7F984720ED14F6396854AD1ABCA4FE72C88DC4F00000000FDFD0000483045022100939D7023833AAFFCB0DC2E6A0065316B90B7987BF3F4D99C5BC8811811782F34022064B5C3EF966E3312D615A06A3119D7599F12621BB92AC5CF1D971EF1AD9C8A65014730440220394151FB40EDD54326FA829EC571165A5E9168484293FD77E3713A35A701B43B02206B0FFF8488597790E2F6D62847CDE16DE3234439800F019423E7BEF881311862014C695221032C6AA78662CC43A3BB0F8F850D0C45E18D0A49C61EC69DB87E072C88D7A9B6E9210353581FD2FC745D17264AF8CB8CD507D82C9658962567218965E750590E41C41E21024FE45DD4749347D281FD5348F56E883EE3A00903AF899301AC47BA90F904854F53AEFFFFFFFF";
        testConfig.transactionOutputIndex = 1;
        testConfig.transactionOutputBytes = "409334020000000017A91493DD75558893D97C53005F6B63B9E4005401A93187";
        testConfig.blockHeight = 177653L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A91493DD75558893D97C53005F6B63B9E4005401A93187";
        testConfig.unlockingScriptBytes = "00483045022100939D7023833AAFFCB0DC2E6A0065316B90B7987BF3F4D99C5BC8811811782F34022064B5C3EF966E3312D615A06A3119D7599F12621BB92AC5CF1D971EF1AD9C8A65014730440220394151FB40EDD54326FA829EC571165A5E9168484293FD77E3713A35A701B43B02206B0FFF8488597790E2F6D62847CDE16DE3234439800F019423E7BEF881311862014C695221032C6AA78662CC43A3BB0F8F850D0C45E18D0A49C61EC69DB87E072C88D7A9B6E9210353581FD2FC745D17264AF8CB8CD507D82C9658962567218965E750590E41C41E21024FE45DD4749347D281FD5348F56E883EE3A00903AF899301AC47BA90F904854F53AE";

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_0ADF1D18C0620CF2AF88DF250402A3D0E5CD90BC081E5BFF0EEE0631A9B232C0_2() {
        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "01000000045930CB11E0447A833C4EB510494D0DB9A73B8489085002806B4938DAD91A4D4C010000008B483045022100C47CCD574FEA4677B942CC2A5FD49D44CB9827996A090D86BBFEC14286C158D3022067377B328848AF6718BE8ED4F7DA7841DEFAFE9CA013DC5ED4FCD7BD86F2698601410459ED4A6929F45F4C40ED221DE16ADEBA13AD9F35E47C69DC1081F7F3540539DE2C85CA8A5B2DB1995B18FB1F1D54EE1183775A5362AD6B85A74975671006253DFFFFFFFFB6A82EAA6E0A93E5233FCD34AF2375E42C72BA6711CDCD672819F99AF781A8A5010000008C493046022100CCC7758371F7B9E301183C28696FA721A2E3617D50A3761C6A19D94408C4E753022100D54835B7B08C38A3992A69EED47717AFDC24738B9A81FB311536EC7AD8712613014104E1E5C8ADCA296F2EBBDA9C19FFC7D31732787A75182FF8BEE7EA51C2CD0D20C1CB26E008E49BC9D937D42D15C9686184068DEB9668C8B39F1F6C5D5E3BEB10DEFFFFFFFFB2A2B35A2750E5203820BFE92166E317E1A797327AED713BEE90FD8E2159453F010000008A4730440220710CAA1EBACA07EE4C8D055F57E4967B3948CBD2DBCA0BA002DEC8CA36BEBB0002200032F44BEDB3ABA4AD0CCA5E302B77D6D279B8A9EE3F66D02D5D0EC1BFB89E3E014104C33859AF99F7223FBF819F941143AC90D5DBCCCCF00B2FFAA6A1709F848AEFEF355019643D5727A5FFCFA594F870FB36D64506E6EEEC69624FB1719871CA4247FFFFFFFFAE49869B9ED83890F573211552504753756718332556CD35D535D67B81075EB0010000008B4830450221009DFF4FD759A1ABDCAF713F12465967AF66721604EE75812D61FA73DC633B924702203463AF5D7F1A098F8D705CFFF6AD0864434D526EABF6841F39C6DDA5FECC3754014104EC698E34FBB29B78B49C4574D8EAC51F292E0F72790AD3BC6AF856874715D68FB449E8FD4B05C7313C412C3DBF6788D00005E35C4DDA5A0F832343077520D7B5FFFFFFFF0200E721A2040000001976A91424DD0E523B29A97C039C4F3D605E969E38AFA02488ACF2DDEA4C000000001976A914B9887A490A7CE1CE00610EBC50CB629C02B1C57488AC00000000";
        testConfig.transactionInputBytes = "4730440220710CAA1EBACA07EE4C8D055F57E4967B3948CBD2DBCA0BA002DEC8CA36BEBB0002200032F44BEDB3ABA4AD0CCA5E302B77D6D279B8A9EE3F66D02D5D0EC1BFB89E3E014104C33859AF99F7223FBF819F941143AC90D5DBCCCCF00B2FFAA6A1709F848AEFEF355019643D5727A5FFCFA594F870FB36D64506E6EEEC69624FB1719871CA4247";
        testConfig.transactionOutputIndex = 1;
        testConfig.transactionOutputBytes = "18E94C0C000000001976A9141A49982E41F9B53E6FCDDEEE6EE542BDA4E424DC88AC";
        testConfig.blockHeight = 169940L;
        testConfig.transactionInputIndex = 2;
        testConfig.lockingScriptBytes = "76A9141A49982E41F9B53E6FCDDEEE6EE542BDA4E424DC88AC";
        testConfig.unlockingScriptBytes = "4730440220710CAA1EBACA07EE4C8D055F57E4967B3948CBD2DBCA0BA002DEC8CA36BEBB0002200032F44BEDB3ABA4AD0CCA5E302B77D6D279B8A9EE3F66D02D5D0EC1BFB89E3E014104C33859AF99F7223FBF819F941143AC90D5DBCCCCF00B2FFAA6A1709F848AEFEF355019643D5727A5FFCFA594F870FB36D64506E6EEEC69624FB1719871CA4247";

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_51BF528ECF3C161E7C021224197DBE84F9A8564212F6207BAA014C01A1668E1E_0() {
        // NOTE: This transaction relies on SIGHASH_ANYONECANPAY...

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "0100000002F6044C0AD485F633B41F97D0D793EB2837AE40F738FF6D5F50FDFD10528C1D76010000006B48304502205853C7F1395785BFABB03C57E962EB076FF24D8E4E573B04DB13B45ED3ED6EE20221009DC82AE43BE9D4B1FE2847754E1D36DAD48BA801817D485DC529AFC516C2DDB481210305584980367B321FAD7F1C1F4D5D723D0AC80C1D80C8BA12343965B48364537AFFFFFFFF9C6AF0DF6669BCDED19E317E25BEBC8C78E48DF8AE1FE02A7F030818E71ECD40010000006C4930460221008269C9D7BA0A7E730DD16F4082D29E3684FB7463BA064FD093AFC170AD6E0388022100BC6D76373916A3FF6EE41B2C752001FDA3C9E048BCFF0D81D05B39FF0F4217B2812103AAE303D825421545C5BC7CCD5AC87DD5ADD3BCC3A432BA7AA2F2661699F9F659FFFFFFFF01E0930400000000001976A9145C11F917883B927EEF77DC57707AEB853F6D389488AC00000000";
        testConfig.transactionInputBytes = "F6044C0AD485F633B41F97D0D793EB2837AE40F738FF6D5F50FDFD10528C1D76010000006B48304502205853C7F1395785BFABB03C57E962EB076FF24D8E4E573B04DB13B45ED3ED6EE20221009DC82AE43BE9D4B1FE2847754E1D36DAD48BA801817D485DC529AFC516C2DDB481210305584980367B321FAD7F1C1F4D5D723D0AC80C1D80C8BA12343965B48364537AFFFFFFFF";
        testConfig.transactionOutputIndex = 1;
        testConfig.transactionOutputBytes = "400D0300000000001976A9148551E48A53DECD1CFC63079A4581BCCCFAD1A93C88AC";
        testConfig.blockHeight = 207733L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "76A9148551E48A53DECD1CFC63079A4581BCCCFAD1A93C88AC";
        testConfig.unlockingScriptBytes = "48304502205853C7F1395785BFABB03C57E962EB076FF24D8E4E573B04DB13B45ED3ED6EE20221009DC82AE43BE9D4B1FE2847754E1D36DAD48BA801817D485DC529AFC516C2DDB481210305584980367B321FAD7F1C1F4D5D723D0AC80C1D80C8BA12343965B48364537A";

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_7208E5EDF525F04E705FB3390194E316205B8F995C8C9FCD8C6093ABE04FA27D_0() {
        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "0100000001774431E6CCCA53548400E2E8BB66865CA2FEEF7885F09A0199B5FDD0EEB7583E01000000DC004930460221008662E2BFCC4741D92531F566C5765D849E24B45C289607593584FBBA938D88CC022100D718E710D5991BDFBDC5B0D52AE8E4D9C1C1C719BCC348003C5E80524A04E16283483045022100FBDBEA6B614989B210D269DBF171746A9507BB3DAE292BDAF85848A7AA091ECA02205D23A46269A904C40076C76EADFDB8F98E7D0349C0BFE5915CCA3F8835A4A41683475221034758CEFCB75E16E4DFAFB32383B709FA632086EA5CA982712DE6ADD93060B17A2103FE96237629128A0AE8C3825AF8A4BE8FE3109B16F62AF19CEC0B1EB93B8717E252AEFFFFFFFF0280969800000000001976A914F164A82C9B3C5D217C83380792D56A6261F2D17688AC609DF200000000001976A9142AB55D985E552653C189B1530AAC817C0223CB4C88AC00000000";
        testConfig.transactionInputBytes = "774431E6CCCA53548400E2E8BB66865CA2FEEF7885F09A0199B5FDD0EEB7583E01000000DC004930460221008662E2BFCC4741D92531F566C5765D849E24B45C289607593584FBBA938D88CC022100D718E710D5991BDFBDC5B0D52AE8E4D9C1C1C719BCC348003C5E80524A04E16283483045022100FBDBEA6B614989B210D269DBF171746A9507BB3DAE292BDAF85848A7AA091ECA02205D23A46269A904C40076C76EADFDB8F98E7D0349C0BFE5915CCA3F8835A4A41683475221034758CEFCB75E16E4DFAFB32383B709FA632086EA5CA982712DE6ADD93060B17A2103FE96237629128A0AE8C3825AF8A4BE8FE3109B16F62AF19CEC0B1EB93B8717E252AEFFFFFFFF";
        testConfig.transactionOutputIndex = 1;
        testConfig.transactionOutputBytes = "80BA8C010000000017A914D0C15A7D41500976056B3345F542D8C944077C8A87";
        testConfig.blockHeight = 217657L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A914D0C15A7D41500976056B3345F542D8C944077C8A87";
        testConfig.unlockingScriptBytes = "004930460221008662E2BFCC4741D92531F566C5765D849E24B45C289607593584FBBA938D88CC022100D718E710D5991BDFBDC5B0D52AE8E4D9C1C1C719BCC348003C5E80524A04E16283483045022100FBDBEA6B614989B210D269DBF171746A9507BB3DAE292BDAF85848A7AA091ECA02205D23A46269A904C40076C76EADFDB8F98E7D0349C0BFE5915CCA3F8835A4A41683475221034758CEFCB75E16E4DFAFB32383B709FA632086EA5CA982712DE6ADD93060B17A2103FE96237629128A0AE8C3825AF8A4BE8FE3109B16F62AF19CEC0B1EB93B8717E252AE";

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_AFD9C17F8913577EC3509520BD6E5D63E9C0FD2A5F70C787993B097BA6CA9FAE_0() {
        // NOTE: This transaction has multiple inputs using SIGHASH_SINGLE

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "010000000370AC0A1AE588AAF284C308D67CA92C69A39E2DB81337E563BF40C59DA0A5CF63000000006A4730440220360D20BAFF382059040BA9BE98947FD678FB08AAB2BB0C172EFA996FD8ECE9B702201B4FB0DE67F015C90E7AC8A193AEAB486A1F587E0F54D0FB9552EF7F5CE6CAEC032103579CA2E6D107522F012CD00B52B9A65FB46F0C57B9B8B6E377C48F526A44741AFFFFFFFF7D815B6447E35FBEA097E00E028FB7DFBAD4F3F0987B4734676C84F3FCD0E804010000006B483045022100C714310BE1E3A9FF1C5F7CACC65C2D8E781FC3A88CEB063C6153BF950650802102200B2D0979C76E12BB480DA635F192CC8DC6F905380DD4AC1FF35A4F68F462FFFD032103579CA2E6D107522F012CD00B52B9A65FB46F0C57B9B8B6E377C48F526A44741AFFFFFFFF3F1F097333E4D46D51F5E77B53264DB8F7F5D2E18217E1099957D0F5AF7713EE010000006C493046022100B663499EF73273A3788DEA342717C2640AC43C5A1CF862C9E09B206FCB3F6BB8022100B09972E75972D9148F2BDD462E5CB69B57C1214B88FC55CA638676C07CFC10D8032103579CA2E6D107522F012CD00B52B9A65FB46F0C57B9B8B6E377C48F526A44741AFFFFFFFF0380841E00000000001976A914BFB282C70C4191F45B5A6665CAD1682F2C9CFDFB88AC80841E00000000001976A9149857CC07BED33A5CF12B9C5E0500B675D500C81188ACE0FD1C00000000001976A91443C52850606C872403C0601E69FA34B26F62DB4A88AC00000000";
        testConfig.transactionInputBytes = "70AC0A1AE588AAF284C308D67CA92C69A39E2DB81337E563BF40C59DA0A5CF63000000006A4730440220360D20BAFF382059040BA9BE98947FD678FB08AAB2BB0C172EFA996FD8ECE9B702201B4FB0DE67F015C90E7AC8A193AEAB486A1F587E0F54D0FB9552EF7F5CE6CAEC032103579CA2E6D107522F012CD00B52B9A65FB46F0C57B9B8B6E377C48F526A44741AFFFFFFFF";
        testConfig.transactionOutputIndex = 0;
        testConfig.transactionOutputBytes = "80841E00000000001976A914DCF72C4FD02F5A987CF9B02F2FABFCAC3341A87D88AC";
        testConfig.blockHeight = 238798L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "76A914DCF72C4FD02F5A987CF9B02F2FABFCAC3341A87D88AC";
        testConfig.unlockingScriptBytes = "4730440220360D20BAFF382059040BA9BE98947FD678FB08AAB2BB0C172EFA996FD8ECE9B702201B4FB0DE67F015C90E7AC8A193AEAB486A1F587E0F54D0FB9552EF7F5CE6CAEC032103579CA2E6D107522F012CD00B52B9A65FB46F0C57B9B8B6E377C48F526A44741A";

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_AFD9C17F8913577EC3509520BD6E5D63E9C0FD2A5F70C787993B097BA6CA9FAE_1() {
        // NOTE: This transaction has multiple inputs using SIGHASH_SINGLE and is the second half of the above scenario...

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "010000000370AC0A1AE588AAF284C308D67CA92C69A39E2DB81337E563BF40C59DA0A5CF63000000006A4730440220360D20BAFF382059040BA9BE98947FD678FB08AAB2BB0C172EFA996FD8ECE9B702201B4FB0DE67F015C90E7AC8A193AEAB486A1F587E0F54D0FB9552EF7F5CE6CAEC032103579CA2E6D107522F012CD00B52B9A65FB46F0C57B9B8B6E377C48F526A44741AFFFFFFFF7D815B6447E35FBEA097E00E028FB7DFBAD4F3F0987B4734676C84F3FCD0E804010000006B483045022100C714310BE1E3A9FF1C5F7CACC65C2D8E781FC3A88CEB063C6153BF950650802102200B2D0979C76E12BB480DA635F192CC8DC6F905380DD4AC1FF35A4F68F462FFFD032103579CA2E6D107522F012CD00B52B9A65FB46F0C57B9B8B6E377C48F526A44741AFFFFFFFF3F1F097333E4D46D51F5E77B53264DB8F7F5D2E18217E1099957D0F5AF7713EE010000006C493046022100B663499EF73273A3788DEA342717C2640AC43C5A1CF862C9E09B206FCB3F6BB8022100B09972E75972D9148F2BDD462E5CB69B57C1214B88FC55CA638676C07CFC10D8032103579CA2E6D107522F012CD00B52B9A65FB46F0C57B9B8B6E377C48F526A44741AFFFFFFFF0380841E00000000001976A914BFB282C70C4191F45B5A6665CAD1682F2C9CFDFB88AC80841E00000000001976A9149857CC07BED33A5CF12B9C5E0500B675D500C81188ACE0FD1C00000000001976A91443C52850606C872403C0601E69FA34B26F62DB4A88AC00000000";
        testConfig.transactionInputBytes = "7D815B6447E35FBEA097E00E028FB7DFBAD4F3F0987B4734676C84F3FCD0E804010000006B483045022100C714310BE1E3A9FF1C5F7CACC65C2D8E781FC3A88CEB063C6153BF950650802102200B2D0979C76E12BB480DA635F192CC8DC6F905380DD4AC1FF35A4F68F462FFFD032103579CA2E6D107522F012CD00B52B9A65FB46F0C57B9B8B6E377C48F526A44741AFFFFFFFF";
        testConfig.transactionOutputIndex = 1;
        testConfig.transactionOutputBytes = "80841E00000000001976A914DCF72C4FD02F5A987CF9B02F2FABFCAC3341A87D88AC";
        testConfig.blockHeight = 238798L;
        testConfig.transactionInputIndex = 1;
        testConfig.lockingScriptBytes = "76A914DCF72C4FD02F5A987CF9B02F2FABFCAC3341A87D88AC";
        testConfig.unlockingScriptBytes = "483045022100C714310BE1E3A9FF1C5F7CACC65C2D8E781FC3A88CEB063C6153BF950650802102200B2D0979C76E12BB480DA635F192CC8DC6F905380DD4AC1FF35A4F68F462FFFD032103579CA2E6D107522F012CD00B52B9A65FB46F0C57B9B8B6E377C48F526A44741A";

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_315AC7D4C26D69668129CC352851D9389B4A6868F1509C6C8B66BEAD11E2619F_1() {
        // NOTE: This transactions triggers the (infamous) bug that occurs when SIGHASH_SINGLE is used on an input that doesn't have a matching output.
        //  Original Discussion: https://bitcointalk.org/index.php?topic=260595.0

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "0100000002DC38E9359BD7DA3B58386204E186D9408685F427F5E513666DB735AA8A6B2169000000006A47304402205D8FEEB312478E468D0B514E63E113958D7214FA572ACD87079A7F0CC026FC5C02200FA76EA05BF243AF6D0F9177F241CAF606D01FCFD5E62D6BEFBCA24E569E5C27032102100A1A9CA2C18932D6577C58F225580184D0E08226D41959874AC963E3C1B2FEFFFFFFFFDC38E9359BD7DA3B58386204E186D9408685F427F5E513666DB735AA8A6B2169010000006B4830450220087EDE38729E6D35E4F515505018E659222031273B7366920F393EE3AB17BC1E022100CA43164B757D1A6D1235F13200D4B5F76DD8FDA4EC9FC28546B2DF5B1211E8DF03210275983913E60093B767E85597CA9397FB2F418E57F998D6AFBBC536116085B1CBFFFFFFFF0140899500000000001976A914FCC9B36D38CF55D7D5B4EE4DDDB6B2C17612F48C88AC00000000";
        testConfig.transactionInputBytes = "DC38E9359BD7DA3B58386204E186D9408685F427F5E513666DB735AA8A6B2169010000006B4830450220087EDE38729E6D35E4F515505018E659222031273B7366920F393EE3AB17BC1E022100CA43164B757D1A6D1235F13200D4B5F76DD8FDA4EC9FC28546B2DF5B1211E8DF03210275983913E60093B767E85597CA9397FB2F418E57F998D6AFBBC536116085B1CBFFFFFFFF";
        testConfig.transactionOutputIndex = 1;
        testConfig.transactionOutputBytes = "F0874B00000000001976A91433CEF61749D11BA2ADF091A5E045678177FE3A6D88AC";
        testConfig.blockHeight = 247940L;
        testConfig.transactionInputIndex = 1;
        testConfig.lockingScriptBytes = "76A91433CEF61749D11BA2ADF091A5E045678177FE3A6D88AC";
        testConfig.unlockingScriptBytes = "4830450220087EDE38729E6D35E4F515505018E659222031273B7366920F393EE3AB17BC1E022100CA43164B757D1A6D1235F13200D4B5F76DD8FDA4EC9FC28546B2DF5B1211E8DF03210275983913E60093B767E85597CA9397FB2F418E57F998D6AFBBC536116085B1CB";

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_DA47BD83967D81F3CF6520F4FF81B3B6C4797BFE7AC2B5969AEDBF01A840CDA6_2() {
        // NOTE: This transaction spends the first control-group opcodes.
        //  This transaction also contains multiple OP_ELSE Opcodes in succession, asserting that "OP_IF .. OP_ELSE .. OP_ELSE .. OP_ENDIF" is a valid paradigm.

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "0100000003FE1A25C8774C1E827F9EBDAE731FE609FF159D6F7C15094E1D467A99A01E03100000000002012AFFFFFFFF53A080075D834402E916390940782236B29D23DB6F52DFC940A12B3EFF99159C0000000000FFFFFFFF61E4ED95239756BBB98D11DCF973146BE0C17CC1CC94340DEB8BC4D44CD88E92000000000A516352676A675168948CFFFFFFFF0220AA4400000000001976A9149BC0BBDD3024DA4D0C38ED1AECF5C68DD1D3FA1288AC20AA4400000000001976A914169FF4804FD6596DEB974F360C21584AA1E19C9788AC00000000";
        testConfig.transactionInputBytes = "61E4ED95239756BBB98D11DCF973146BE0C17CC1CC94340DEB8BC4D44CD88E92000000000A516352676A675168948CFFFFFFFF";
        testConfig.transactionOutputIndex = 0;
        testConfig.transactionOutputBytes = "40548900000000000763516751676A68";
        testConfig.blockHeight = 249977L;
        testConfig.transactionInputIndex = 2;
        testConfig.lockingScriptBytes = "63516751676A68";
        testConfig.unlockingScriptBytes = "516352676A675168948C";

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_61A078472543E9DE9247446076320499C108B52307D8D0FAFBE53B5C4E32ACC4_0() {
        // 16cfb9bc7654ef1d7723e5c2722fc0c3d505045e OP_SIZE OP_DUP 1 OP_GREATERTHAN OP_VERIFY OP_NEGATE OP_HASH256 OP_HASH160 OP_SHA256 OP_SHA1 OP_RIPEMD160 OP_EQUAL

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "0100000001D9A6B4DB2F4928ED172C22C8A2AB941F026277BF5DDE97E4C5A26E946BC9425300000000151416CFB9BC7654EF1D7723E5C2722FC0C3D505045EFFFFFFFF01D0E89600000000001976A914B0C1C1DE86419F7C6F3186935E6BD6CCB52B8EE588AC00000000";
        testConfig.transactionInputBytes = "D9A6B4DB2F4928ED172C22C8A2AB941F026277BF5DDE97E4C5A26E946BC9425300000000151416CFB9BC7654EF1D7723E5C2722FC0C3D505045EFFFFFFFF";
        testConfig.transactionOutputIndex = 0;
        testConfig.transactionOutputBytes = "E00F9700000000000C827651A0698FAAA9A8A7A687";
        testConfig.blockHeight = 251685L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "827651A0698FAAA9A8A7A687";
        testConfig.unlockingScriptBytes = "1416CFB9BC7654EF1D7723E5C2722FC0C3D505045E";

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_54FABD73F1D20C980A0686BF0035078E07F69C58437E4D586FB29AA0BEE9814F_0() {
        // NOTE: This transactions spends the first IS_WITHIN_RANGE, and ALT_STACK(s) opcode.

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "01000000010C0E314BD7BB14721B3CFD8E487CD6866173354F87CA2CF4D13C8D3FEB4301A6000000004A483045022100D92E4B61452D91A473A43CDE4B469A472467C0BA0CBD5EBBA0834E4F4762810402204802B76B7783DB57AC1F61D2992799810E173E91055938750815B6D8A675902E014FFFFFFFFF0140548900000000001976A914A86E8EE2A05A44613904E18132E49B2448ADC4E688AC00000000";
        testConfig.transactionInputBytes = "0C0E314BD7BB14721B3CFD8E487CD6866173354F87CA2CF4D13C8D3FEB4301A6000000004A483045022100D92E4B61452D91A473A43CDE4B469A472467C0BA0CBD5EBBA0834E4F4762810402204802B76B7783DB57AC1F61D2992799810E173E91055938750815B6D8A675902E014FFFFFFFFF";
        testConfig.transactionOutputIndex = 0;
        testConfig.transactionOutputBytes = "40548900000000002D76009F69905160A56B210378D430274F8C5EC1321338151E9F27F4C676A008BDF8638D07C0B6BE9AB35C71AD6C";
        testConfig.blockHeight = 256962L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "76009F69905160A56B210378D430274F8C5EC1321338151E9F27F4C676A008BDF8638D07C0B6BE9AB35C71AD6C";
        testConfig.unlockingScriptBytes = "483045022100D92E4B61452D91A473A43CDE4B469A472467C0BA0CBD5EBBA0834E4F4762810402204802B76B7783DB57AC1F61D2992799810E173E91055938750815B6D8A675902E014F";
        testConfig.medianBlockTime = 1378738978L;

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_567A53D1CE19CE3D07711885168484439965501536D0D0294C5D46D46C10E53B_0() {
        // P2SH: (0x6E OP_DYNAMIC_VALUE-COPY_2ND_THEN_1ST) (0x87 OP_COMPARISON-IS_EQUAL) (0x91 OP_ARITHMETIC-NOT) (0x69 OP_CONTROL-VERIFY) (0x90 OP_ARITHMETIC-ABSOLUTE_VALUE) (0x7C OP_STACK-SWAP_1ST_WITH_2ND) (0x90 OP_ARITHMETIC-ABSOLUTE_VALUE) (0x87 OP_COMPARISON-IS_EQUAL)

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "0100000001F18CDA90BBBCFB031C65CEDA17C82DC046C7DB0B96242BA4C5B53C411D8C056E020000000C510181086E879169907C9087FFFFFFFF01A0BB0D00000000001976A9149BC0BBDD3024DA4D0C38ED1AECF5C68DD1D3FA1288AC00000000";
        testConfig.transactionInputBytes = "F18CDA90BBBCFB031C65CEDA17C82DC046C7DB0B96242BA4C5B53C411D8C056E020000000C510181086E879169907C9087FFFFFFFF";
        testConfig.transactionOutputIndex = 2;
        testConfig.transactionOutputBytes = "40420F000000000017A914FE441065B6532231DE2FAC563152205EC4F59C7487";
        testConfig.blockHeight = 257728L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A914FE441065B6532231DE2FAC563152205EC4F59C7487";
        testConfig.unlockingScriptBytes = "510181086E879169907C9087";
        testConfig.medianBlockTime = 1379070870L;

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_E218970E8F810BE99D60AA66262A1D382BC4B1A26A69AF07AC47D622885DB1A7_0() {
        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "01000000017047D51EB2671F08BE60033DC273DA6BF165AEAE6F0D2B2C901CCEDC592FC84E000000008B48304502210085807B5A614A1A2FAF0209C7D95BF046393C19BBBDB2CCAFD8CF1E87B906429E02204405C1B759E7A44BDFDD053198F5307F07830E54110BAC58C36B40A19AD8CD3A044104BB8F7EBE793C32E49C8F2B929B09CA09EE2B4F121B32C9DFCA121450BC2B6762C75ECE327C6724C30BFD14430AB4803371185E9060721DEFF8BDFA7F2CE5D751FFFFFFFF0100710200000000001976A9141E2F6AF9A8564C0CB58B8662DC2C63E70BD8B35288AC00000000";
        testConfig.transactionInputBytes = "7047D51EB2671F08BE60033DC273DA6BF165AEAE6F0D2B2C901CCEDC592FC84E000000008B48304502210085807B5A614A1A2FAF0209C7D95BF046393C19BBBDB2CCAFD8CF1E87B906429E02204405C1B759E7A44BDFDD053198F5307F07830E54110BAC58C36B40A19AD8CD3A044104BB8F7EBE793C32E49C8F2B929B09CA09EE2B4F121B32C9DFCA121450BC2B6762C75ECE327C6724C30BFD14430AB4803371185E9060721DEFF8BDFA7F2CE5D751FFFFFFFF";
        testConfig.transactionOutputIndex = 2;
        testConfig.transactionOutputBytes = "50340300000000001976A914A7A120D4358DD1E8BC9566329EAD42C4F394CCFC88AC";
        testConfig.blockHeight = 260789L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "76A914A7A120D4358DD1E8BC9566329EAD42C4F394CCFC88AC";
        testConfig.unlockingScriptBytes = "48304502210085807B5A614A1A2FAF0209C7D95BF046393C19BBBDB2CCAFD8CF1E87B906429E02204405C1B759E7A44BDFDD053198F5307F07830E54110BAC58C36B40A19AD8CD3A044104BB8F7EBE793C32E49C8F2B929B09CA09EE2B4F121B32C9DFCA121450BC2B6762C75ECE327C6724C30BFD14430AB4803371185E9060721DEFF8BDFA7F2CE5D751";

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_BA4F9786BB34571BD147448AB3C303AE4228B9C22C89E58CC50E26FF7538BF80_0() {
        // Non-Standard HashType: 0x50

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "010000000140ED240A0A018469A1CDD3656800C23EC796D698D82EA336C4B6FB72B141C9CD000000008B483045022100DE3B4C67E8A3EB09F18E8B5834257C0A27812DF490365B8AC0E30E1D3DCC01630220426997EE904736647AE2E0B93CB2A11511F7B33E8F8A8CE0C5265CBD5B113AE8504104B1796B0E02F327E1A6F61ABDFF028374DE9C80D6189460B0B7035752A2D00364FB19F16868BA34A4E93350E49E6FF8BFB48D23AB15F14871B01D6562F69B9973FFFFFFFF0300E1F505000000001976A914AC625F248F3BE5C1C17767B8B2B93DD03553984788ACE0E2CF17000000001976A9142C00769E224AC558CF0E726C8E4D6AA9D34F6E5688AC107A0700000000001976A9144BD0AC767D24ACC4C5AF736767B7B3ACD1A6776188AC00000000";
        testConfig.transactionInputBytes = "40ED240A0A018469A1CDD3656800C23EC796D698D82EA336C4B6FB72B141C9CD000000008B483045022100DE3B4C67E8A3EB09F18E8B5834257C0A27812DF490365B8AC0E30E1D3DCC01630220426997EE904736647AE2E0B93CB2A11511F7B33E8F8A8CE0C5265CBD5B113AE8504104B1796B0E02F327E1A6F61ABDFF028374DE9C80D6189460B0B7035752A2D00364FB19F16868BA34A4E93350E49E6FF8BFB48D23AB15F14871B01D6562F69B9973FFFFFFFF";
        testConfig.transactionOutputIndex = 2;
        testConfig.transactionOutputBytes = "0065CD1D000000001976A914990A8E1EB7A69C41602BD46FED56B6A38FD9BC1E88AC";
        testConfig.blockHeight = 264085L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "76A914990A8E1EB7A69C41602BD46FED56B6A38FD9BC1E88AC";
        testConfig.unlockingScriptBytes = "483045022100DE3B4C67E8A3EB09F18E8B5834257C0A27812DF490365B8AC0E30E1D3DCC01630220426997EE904736647AE2E0B93CB2A11511F7B33E8F8A8CE0C5265CBD5B113AE8504104B1796B0E02F327E1A6F61ABDFF028374DE9C80D6189460B0B7035752A2D00364FB19F16868BA34A4E93350E49E6FF8BFB48D23AB15F14871B01D6562F69B9973";

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_9FB65B7304AAA77AC9580823C2C06B259CC42591E5CCE66D76A81B6F51CC5C28_0() {
        // NOTE: This transaction expects an invalid scriptSignature.  The invalid scriptSignature is permitted, and expects a zero to be placed on the stack.

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "0100000001545959FEA5F64C7D0CC4199A175EBFA6EB29415CF72ACD7676DEDAAD8170CEA6000000008C20CA42095840735E89283FEC298E62AC2DDEA9B5F34A8CBB7097AD965B87568100201B1B01DC829177DA4A14551D2FC96A9DB00C6501EDFA12F22CD9CEFD335C227F483045022100940A7A74D00D590DC6743C8D7416475845611047BED013DB2C4F80C96261576A02202B223572A37C2EEE65FEFABF701B2F39E3DF2CBA5D136EEF0485D9A24F49C0AA0100FFFFFFFF010071020000000000232103611F9A45C18F28F06F19076AD571C344C82CE8FCFE34464CF8085217A2D294A6AC00000000";
        testConfig.transactionInputBytes = "545959FEA5F64C7D0CC4199A175EBFA6EB29415CF72ACD7676DEDAAD8170CEA6000000008C20CA42095840735E89283FEC298E62AC2DDEA9B5F34A8CBB7097AD965B87568100201B1B01DC829177DA4A14551D2FC96A9DB00C6501EDFA12F22CD9CEFD335C227F483045022100940A7A74D00D590DC6743C8D7416475845611047BED013DB2C4F80C96261576A02202B223572A37C2EEE65FEFABF701B2F39E3DF2CBA5D136EEF0485D9A24F49C0AA0100FFFFFFFF";
        testConfig.transactionOutputIndex = 2;
        testConfig.transactionOutputBytes = "1098020000000000B52102085C6600657566ACC2D6382A47BC3F324008D2AA10940DD7705A48AA2A5A5E33AC7C2103F5D0FB955F95DD6BE6115CE85661DB412EC6A08ABCBFCE7DA0BA8297C6CC0EC4AC7C5379A820D68DF9E32A147CFFA36193C6F7C43A1C8C69CDA530E1C6DB354BFABDCFEFAF3C875379A820F531F3041D3136701EA09067C53E7159C8F9B2746A56C3D82966C54BBC553226879A5479827701200122A59A5379827701200122A59A6353798277537982778779679A68";
        testConfig.blockHeight = 268562L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "2102085C6600657566ACC2D6382A47BC3F324008D2AA10940DD7705A48AA2A5A5E33AC7C2103F5D0FB955F95DD6BE6115CE85661DB412EC6A08ABCBFCE7DA0BA8297C6CC0EC4AC7C5379A820D68DF9E32A147CFFA36193C6F7C43A1C8C69CDA530E1C6DB354BFABDCFEFAF3C875379A820F531F3041D3136701EA09067C53E7159C8F9B2746A56C3D82966C54BBC553226879A5479827701200122A59A5379827701200122A59A6353798277537982778779679A68";
        testConfig.unlockingScriptBytes = "20CA42095840735E89283FEC298E62AC2DDEA9B5F34A8CBB7097AD965B87568100201B1B01DC829177DA4A14551D2FC96A9DB00C6501EDFA12F22CD9CEFD335C227F483045022100940A7A74D00D590DC6743C8D7416475845611047BED013DB2C4F80C96261576A02202B223572A37C2EEE65FEFABF701B2F39E3DF2CBA5D136EEF0485D9A24F49C0AA0100";

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_AEF4CF7ABCD4344AE612D5F27735010A26E5102AF20A97A5F43802583D72EB78_0() {
        // NOTE: This transactions spends the first transaction containing OP_ROT (ROTATE_TOP_3)...

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "0100000001A48A2CF33ECD5134784418646820BD69D6C1CEFF36DD5497200073D56B810D5400000000AB47304402207D9184B4E4A1FE11BCB7743DB85F1F82FF00AB8C54F58B44DE2AE50D8B1C35F3022019D9F60CD927A317E258D7EE3B9CEBA49CD2A6BF15C195E4FC5D5F5915B83B620120CA42095840735E89283FEC298E62AC2DDEA9B5F34A8CBB7097AD965B87568123201B1B01DC829177DA4A14551D2FC96A9DB00C6501EDFA12F22CD9CEFD335C227F202C2C01DC829177DA4A14551D2FC96A9DB00C6501EDFA12F22CD9CEFD335C338EFFFFFFFF012030050000000000434104C9CE67FF2DF2CD6BE5F58345B4E311C5F10AAB49D3CF3F73E8DCAC1F9CD0DE966E924BE091E7BC854AEF0D0BAAFA80FE5F2D6AF56B1788E1E8EC8D241B41C40DAC00000000";
        testConfig.transactionInputBytes = "A48A2CF33ECD5134784418646820BD69D6C1CEFF36DD5497200073D56B810D5400000000AB47304402207D9184B4E4A1FE11BCB7743DB85F1F82FF00AB8C54F58B44DE2AE50D8B1C35F3022019D9F60CD927A317E258D7EE3B9CEBA49CD2A6BF15C195E4FC5D5F5915B83B620120CA42095840735E89283FEC298E62AC2DDEA9B5F34A8CBB7097AD965B87568123201B1B01DC829177DA4A14551D2FC96A9DB00C6501EDFA12F22CD9CEFD335C227F202C2C01DC829177DA4A14551D2FC96A9DB00C6501EDFA12F22CD9CEFD335C338EFFFFFFFF";
        testConfig.transactionOutputIndex = 2;
        testConfig.transactionOutputBytes = "3057050000000000FD6301827D01200123A569A820197BF68FB520E8D3419DC1D4AC1EB89E7DFD7CFE561C19ABF7611D7626D9F02C887C827D01200123A569A820F531F3041D3136701EA09067C53E7159C8F9B2746A56C3D82966C54BBC553226887B827D01200123A569A820527CCDD755DCCCF03192383624E0A7D0263815CE2ECF1F69CB0423AB7E6F0F3E8893930160947652A0635394687652A0635394684104D4BF4642F56FC7AF0D2382E2CAC34FA16ED3321633F91D06128F0E5C0D17479778CC1F2CC7E4A0C6F1E72D905532E8E127A031BB9794B3EF9B68B657F51CC6914104208A50909284AEDE02AD107BB1F52175B025CDF0453537B686433BCADE6D3E210B6C82BCBDF8676B2161687E232F5D9AFDAA4ED7B3E3BF9608D41B40EBDE6ED44104C9CE67FF2DF2CD6BE5F58345B4E311C5F10AAB49D3CF3F73E8DCAC1F9CD0DE966E924BE091E7BC854AEF0D0BAAFA80FE5F2D6AF56B1788E1E8EC8D241B41C40D537A7A537A7CAD";
        testConfig.blockHeight = 269615L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "827D01200123A569A820197BF68FB520E8D3419DC1D4AC1EB89E7DFD7CFE561C19ABF7611D7626D9F02C887C827D01200123A569A820F531F3041D3136701EA09067C53E7159C8F9B2746A56C3D82966C54BBC553226887B827D01200123A569A820527CCDD755DCCCF03192383624E0A7D0263815CE2ECF1F69CB0423AB7E6F0F3E8893930160947652A0635394687652A0635394684104D4BF4642F56FC7AF0D2382E2CAC34FA16ED3321633F91D06128F0E5C0D17479778CC1F2CC7E4A0C6F1E72D905532E8E127A031BB9794B3EF9B68B657F51CC6914104208A50909284AEDE02AD107BB1F52175B025CDF0453537B686433BCADE6D3E210B6C82BCBDF8676B2161687E232F5D9AFDAA4ED7B3E3BF9608D41B40EBDE6ED44104C9CE67FF2DF2CD6BE5F58345B4E311C5F10AAB49D3CF3F73E8DCAC1F9CD0DE966E924BE091E7BC854AEF0D0BAAFA80FE5F2D6AF56B1788E1E8EC8D241B41C40D537A7A537A7CAD";
        testConfig.unlockingScriptBytes = "47304402207D9184B4E4A1FE11BCB7743DB85F1F82FF00AB8C54F58B44DE2AE50D8B1C35F3022019D9F60CD927A317E258D7EE3B9CEBA49CD2A6BF15C195E4FC5D5F5915B83B620120CA42095840735E89283FEC298E62AC2DDEA9B5F34A8CBB7097AD965B87568123201B1B01DC829177DA4A14551D2FC96A9DB00C6501EDFA12F22CD9CEFD335C227F202C2C01DC829177DA4A14551D2FC96A9DB00C6501EDFA12F22CD9CEFD335C338E";

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_8EA98508EFD1F0AADA5D734F743D1A2F4D23A7E8428A8BE1E820391870EB9A69_0() {
        // NOTE: This transaction relies on zero being encoded as an empty byte array...

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "0100000001EDFF85E3D7B790E3D0E207EA30FBB0CD3BE18370D1C21C26ACFC874CA57B5AA700000000025100FFFFFFFF0178AF12000000000017A914BB89DD62E80D1801DF9AA570769B012F246C4F6D8700000000";
        testConfig.transactionInputBytes = "EDFF85E3D7B790E3D0E207EA30FBB0CD3BE18370D1C21C26ACFC874CA57B5AA700000000025100FFFFFFFF";
        testConfig.transactionOutputIndex = 0;
        testConfig.transactionOutputBytes = "88D612000000000017A914B472A266D0BD89C13706A4132CCFB16F7C3B9FCB87";
        testConfig.blockHeight = 284038L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A914B472A266D0BD89C13706A4132CCFB16F7C3B9FCB87";
        testConfig.unlockingScriptBytes = "5100";

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_5DF1375FFE61AC35CA178EBB0CAB9EA26DEDBD0E96005DFCEE7E379FA513232F_1() {
        // NOTE: This transaction relies on the signatures being removed from the signed script...

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "0100000002F9CBAFC519425637BA4227F8D0A0B7160B4E65168193D5AF39747891DE98B5B5000000006B4830450221008DD619C563E527C47D9BD53534A770B102E40FAA87F61433580E04E271EF2F960220029886434E18122B53D5DECD25F1F4ACB2480659FEA20AABD856987BA3C3907E0121022B78B756E2258AF13779C1A1F37EA6800259716CA4B7F0B87610E0BF3AB52A01FFFFFFFF42E7988254800876B69F24676B3E0205B77BE476512CA4D970707DD5C60598AB00000000FD260100483045022015BD0139BCCCF990A6AF6EC5C1C52ED8222E03A0D51C334DF139968525D2FCD20221009F9EFE325476EB64C3958E4713E9EEFE49BF1D820ED58D2112721B134E2A1A53034930460221008431BDFA72BC67F9D41FE72E94C88FB8F359FFA30B33C72C121C5A877D922E1002210089EF5FC22DD8BFC6BF9FFDB01A9862D27687D424D1FEFBAB9E9C7176844A187A014C9052483045022015BD0139BCCCF990A6AF6EC5C1C52ED8222E03A0D51C334DF139968525D2FCD20221009F9EFE325476EB64C3958E4713E9EEFE49BF1D820ED58D2112721B134E2A1A5303210378D430274F8C5EC1321338151E9F27F4C676A008BDF8638D07C0B6BE9AB35C71210378D430274F8C5EC1321338151E9F27F4C676A008BDF8638D07C0B6BE9AB35C7153AEFFFFFFFF01A08601000000000017A914D8DACDADB7462AE15CD906F1878706D0DA8660E68700000000";
        testConfig.transactionInputBytes = "42E7988254800876B69F24676B3E0205B77BE476512CA4D970707DD5C60598AB00000000FD260100483045022015BD0139BCCCF990A6AF6EC5C1C52ED8222E03A0D51C334DF139968525D2FCD20221009F9EFE325476EB64C3958E4713E9EEFE49BF1D820ED58D2112721B134E2A1A53034930460221008431BDFA72BC67F9D41FE72E94C88FB8F359FFA30B33C72C121C5A877D922E1002210089EF5FC22DD8BFC6BF9FFDB01A9862D27687D424D1FEFBAB9E9C7176844A187A014C9052483045022015BD0139BCCCF990A6AF6EC5C1C52ED8222E03A0D51C334DF139968525D2FCD20221009F9EFE325476EB64C3958E4713E9EEFE49BF1D820ED58D2112721B134E2A1A5303210378D430274F8C5EC1321338151E9F27F4C676A008BDF8638D07C0B6BE9AB35C71210378D430274F8C5EC1321338151E9F27F4C676A008BDF8638D07C0B6BE9AB35C7153AEFFFFFFFF";
        testConfig.transactionOutputIndex = 0;
        testConfig.transactionOutputBytes = "A08601000000000017A914D8DACDADB7462AE15CD906F1878706D0DA8660E687";
        testConfig.blockHeight = 290338L;
        testConfig.transactionInputIndex = 1;
        testConfig.lockingScriptBytes = "A914D8DACDADB7462AE15CD906F1878706D0DA8660E687";
        testConfig.unlockingScriptBytes = "00483045022015BD0139BCCCF990A6AF6EC5C1C52ED8222E03A0D51C334DF139968525D2FCD20221009F9EFE325476EB64C3958E4713E9EEFE49BF1D820ED58D2112721B134E2A1A53034930460221008431BDFA72BC67F9D41FE72E94C88FB8F359FFA30B33C72C121C5A877D922E1002210089EF5FC22DD8BFC6BF9FFDB01A9862D27687D424D1FEFBAB9E9C7176844A187A014C9052483045022015BD0139BCCCF990A6AF6EC5C1C52ED8222E03A0D51C334DF139968525D2FCD20221009F9EFE325476EB64C3958E4713E9EEFE49BF1D820ED58D2112721B134E2A1A5303210378D430274F8C5EC1321338151E9F27F4C676A008BDF8638D07C0B6BE9AB35C71210378D430274F8C5EC1321338151E9F27F4C676A008BDF8638D07C0B6BE9AB35C7153AE";

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_007A90D0A4D4F1DCA9755FDF3F13188FE340311137E246961FB4F0AB6D312835_0() {
        // NOTE: This transaction relies on serializing PUSH_DATA_BYTE correctly. This transaction isn't abnormal, and was difficult mostly due a bug in MutableScript when re-serializing PushOperations...

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "0100000001192EBD3864285054D503FFA674F6A8F28A081F3A4A30FBEBA8FC459D97B9678400000000FD6D0100483045022100B88E83CB8C97AEDAC144A1AE77E25540319D4AE322B92B6CB102FF0B38871326022061D638B32E90B5AE058B437F288D3295080B5CF73FEDBF44A6E512CAA17AAC9F01493046022100B8A8A133A294CFF4B7A846CCD31BC8970F538864819C161E9C614D52B8880978022100E156AE597F317C1F517F7EDA02F86C27F0D465EE35EA39B452B0D5B0E9705BD3014CD752410403F2026EC6C85A1EABD0645A2B8D1588BF6D21B9C0A84452EA6F8165A897E5BC01A5AEA82224D1446C91969BFD28B8F8FE972E77F819C08A96CDEB1BAD02427241043DA7A8D9CE342E84E52AD0FC77F1CE1BBCFE27CC430C1FD51C08EDEF4507B5529A2376CC1EACC8719882A9138486CA202C8D0BE186214FCA4C8BAD7D9EB8889E4C4E0488ADE4038D308C4080000000EBA2CF9E70F23DACEB5DF1226F9DFF91C8DD05DF0A6145EA16CC7D68C4890F3C00771F778FB10A08956EAD0654B5006D4B86AFA79E456DB387903D34A0CA20F06153AEFFFFFFFF01A0860100000000001976A91405F72FB3F57D8291735E7B545478F35A9E0EBDB888AC00000000";
        testConfig.transactionInputBytes = "192EBD3864285054D503FFA674F6A8F28A081F3A4A30FBEBA8FC459D97B9678400000000FD6D0100483045022100B88E83CB8C97AEDAC144A1AE77E25540319D4AE322B92B6CB102FF0B38871326022061D638B32E90B5AE058B437F288D3295080B5CF73FEDBF44A6E512CAA17AAC9F01493046022100B8A8A133A294CFF4B7A846CCD31BC8970F538864819C161E9C614D52B8880978022100E156AE597F317C1F517F7EDA02F86C27F0D465EE35EA39B452B0D5B0E9705BD3014CD752410403F2026EC6C85A1EABD0645A2B8D1588BF6D21B9C0A84452EA6F8165A897E5BC01A5AEA82224D1446C91969BFD28B8F8FE972E77F819C08A96CDEB1BAD02427241043DA7A8D9CE342E84E52AD0FC77F1CE1BBCFE27CC430C1FD51C08EDEF4507B5529A2376CC1EACC8719882A9138486CA202C8D0BE186214FCA4C8BAD7D9EB8889E4C4E0488ADE4038D308C4080000000EBA2CF9E70F23DACEB5DF1226F9DFF91C8DD05DF0A6145EA16CC7D68C4890F3C00771F778FB10A08956EAD0654B5006D4B86AFA79E456DB387903D34A0CA20F06153AEFFFFFFFF";
        testConfig.transactionOutputIndex = 0;
        testConfig.transactionOutputBytes = "400D03000000000017A91491EDFECEC506A49F2997AAD0E8E39C1F55A4273E87";
        testConfig.blockHeight = 299612L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A91491EDFECEC506A49F2997AAD0E8E39C1F55A4273E87";
        testConfig.unlockingScriptBytes = "00483045022100B88E83CB8C97AEDAC144A1AE77E25540319D4AE322B92B6CB102FF0B38871326022061D638B32E90B5AE058B437F288D3295080B5CF73FEDBF44A6E512CAA17AAC9F01493046022100B8A8A133A294CFF4B7A846CCD31BC8970F538864819C161E9C614D52B8880978022100E156AE597F317C1F517F7EDA02F86C27F0D465EE35EA39B452B0D5B0E9705BD3014CD752410403F2026EC6C85A1EABD0645A2B8D1588BF6D21B9C0A84452EA6F8165A897E5BC01A5AEA82224D1446C91969BFD28B8F8FE972E77F819C08A96CDEB1BAD02427241043DA7A8D9CE342E84E52AD0FC77F1CE1BBCFE27CC430C1FD51C08EDEF4507B5529A2376CC1EACC8719882A9138486CA202C8D0BE186214FCA4C8BAD7D9EB8889E4C4E0488ADE4038D308C4080000000EBA2CF9E70F23DACEB5DF1226F9DFF91C8DD05DF0A6145EA16CC7D68C4890F3C00771F778FB10A08956EAD0654B5006D4B86AFA79E456DB387903D34A0CA20F06153AE";

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_C8B86E0DCFE3A1DD48C99EE4B5DDF6172A552303E7F338D49124E060CAF62D09_0() {
        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "01000000015622AA8123681FFFBBB4E4FCF724DFD490EA82BCB3BF46A233E0B63042F1D20300000000FD01014730440220684894B6FF1F8900007F8777EAFB517AD4031E82233694F02AF7FC6D5479F90502202BD76A764CD57FF0295299626A4416CC6828842D9B052EE1AEDCBCA5A4B920460121026BC81B705EC9FCDA7ACE4C4F313FC080E5752366C82CCCD8B79BC1CAF8C11F4607706F7574696E654C8D74B7766B765361876375AA207A73CF250E33244910BD6316B57DBADFCB7A8DEB63E5B3B148D0C7B8465CFCC288B06757B687646A5062898A688F5393B19052945288B5B86C7653936B7C8F5294B990A355886C766B8C56B3948893B454886876A914996140612C8F1CD30E8F446EA35EC94D77778686B288AC1220706F7574696E652F667265656E6F64652075FFFFFFFF01D8E31100000000001976A914996140612C8F1CD30E8F446EA35EC94D7777868688AC00000000";
        testConfig.transactionInputBytes = "5622AA8123681FFFBBB4E4FCF724DFD490EA82BCB3BF46A233E0B63042F1D20300000000FD01014730440220684894B6FF1F8900007F8777EAFB517AD4031E82233694F02AF7FC6D5479F90502202BD76A764CD57FF0295299626A4416CC6828842D9B052EE1AEDCBCA5A4B920460121026BC81B705EC9FCDA7ACE4C4F313FC080E5752366C82CCCD8B79BC1CAF8C11F4607706F7574696E654C8D74B7766B765361876375AA207A73CF250E33244910BD6316B57DBADFCB7A8DEB63E5B3B148D0C7B8465CFCC288B06757B687646A5062898A688F5393B19052945288B5B86C7653936B7C8F5294B990A355886C766B8C56B3948893B454886876A914996140612C8F1CD30E8F446EA35EC94D77778686B288AC1220706F7574696E652F667265656E6F64652075FFFFFFFF";
        testConfig.transactionOutputIndex = 0;
        testConfig.transactionOutputBytes = "E80A12000000000017A9140699E9AB703852E86A01AAFD1F2737ECDB1C926987";
        testConfig.blockHeight = 318346L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A9140699E9AB703852E86A01AAFD1F2737ECDB1C926987";
        testConfig.unlockingScriptBytes = "4730440220684894B6FF1F8900007F8777EAFB517AD4031E82233694F02AF7FC6D5479F90502202BD76A764CD57FF0295299626A4416CC6828842D9B052EE1AEDCBCA5A4B920460121026BC81B705EC9FCDA7ACE4C4F313FC080E5752366C82CCCD8B79BC1CAF8C11F4607706F7574696E654C8D74B7766B765361876375AA207A73CF250E33244910BD6316B57DBADFCB7A8DEB63E5B3B148D0C7B8465CFCC288B06757B687646A5062898A688F5393B19052945288B5B86C7653936B7C8F5294B990A355886C766B8C56B3948893B454886876A914996140612C8F1CD30E8F446EA35EC94D77778686B288AC1220706F7574696E652F667265656E6F64652075";

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_CFD9EC0C6E807FDC30E94793E80559C134D38CE9359F04673C588DB514E9DC4B_5() {
        // NOTE: This transaction failed due to an off-by-one error in SWAP_1ST_2ND_WITH_3RD_4TH...

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "010000000C1806206831C8632AA6B7640B668187167F7803882607B46D6C33C732C536FE38280000000451510177FFFFFFFF1806206831C8632AA6B7640B668187167F7803882607B46D6C33C732C536FE382700000003510176FFFFFFFF1806206831C8632AA6B7640B668187167F7803882607B46D6C33C732C536FE38260000000451510175FFFFFFFF1806206831C8632AA6B7640B668187167F7803882607B46D6C33C732C536FE382500000003510174FFFFFFFF1806206831C8632AA6B7640B668187167F7803882607B46D6C33C732C536FE382400000003510173FFFFFFFF1806206831C8632AA6B7640B668187167F7803882607B46D6C33C732C536FE382300000006515151510172FFFFFFFF1806206831C8632AA6B7640B668187167F7803882607B46D6C33C732C536FE3822000000085151515151510171FFFFFFFF1806206831C8632AA6B7640B668187167F7803882607B46D6C33C732C536FE382100000006515151510170FFFFFFFF1806206831C8632AA6B7640B668187167F7803882607B46D6C33C732C536FE382000000005515151016FFFFFFFFF1806206831C8632AA6B7640B668187167F7803882607B46D6C33C732C536FE381F000000045151016EFFFFFFFF1806206831C8632AA6B7640B668187167F7803882607B46D6C33C732C536FE381E00000005515151016DFFFFFFFF1806206831C8632AA6B7640B668187167F7803882607B46D6C33C732C536FE381C000000045151016BFFFFFFFF01BAEA0000000000001976A91492B8C3A56FAC121DDCDFFBC85B02FB9EF681038A88AC00000000";
        testConfig.transactionInputBytes = "1806206831C8632AA6B7640B668187167F7803882607B46D6C33C732C536FE382300000006515151510172FFFFFFFF";
        testConfig.transactionOutputIndex = 35;
        testConfig.transactionOutputBytes = "7C1500000000000017A9147C6A6BCF5FAA451AB936551201D4332CF31A741E87";
        testConfig.blockHeight = 327499L;
        testConfig.transactionInputIndex = 5;
        testConfig.lockingScriptBytes = "A9147C6A6BCF5FAA451AB936551201D4332CF31A741E87";
        testConfig.unlockingScriptBytes = "515151510172";

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_812243D8D3737767542AA203356D6C781EFEB7F53A99E51FB922E0BDCFDFB455_0() {
        // NOTE: This transactions spends the first SIGHASH_NONE. Its other inputs must have their sequence numbers nullified...

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "01000000029FA3F9993D2806D32D37C530A5BE530463FE8EF6E2D8D51C0BBAA73C4829EEC101000000FD250648304502210098B2ED4050360CB291A5F3986FF373384E85974AB3BC092FDA14E808737A5F6502207F9F8241EBE0BE6A1DE7F9C9F81CA232E02C97C4EC73E392B97461D33891A19E0216000A20202020202020202020202020202020202020004C4D0040436F696E54656C6567726170683A205761726E696E6721204B6173706572736B7920416C65727473205573657273206F66204D616C7761726520616E642027426C6F636B636861696E0A0043002020202020202020202020202020202041627573652720687474703A2F2F646C76722E69742F393837564E702020236D616C776172652023494E544552504F4C0A002D00202020202020202020202020202020207069632E747769747465722E636F6D2F4872304E536B36316E690A0016000A20202020202020202020202020202020202020004C4F00406164616D3375733A202E40436F696E54656C656772617068206D616B6573206E6F2073656E736520746F206D652E206F705F72657475726E206973206E6F742065786563757465642061730A004C4F0020202020202020202020636F646520627920616E792062726F777365723B206F705F72657475726E206D616B657320746865206D6F7374207573656C65737320766972757320766563746F720A00160020202020202020202020657665722E0A202020200016000A20202020202020202020202020202020202020004C520040636F6D6566726F6D6265796F6E643A20406164616D3375732040436F696E54656C656772617068205468657920736169642022626C6F636B636861696E222C206E6F742022426974636F696E222E0A001D00202020202020202020202020202020202023457468657265756D0A0016000A20202020202020202020202020202020202020004C4D00406A6761727A696B3A20406164616D3375732040436F696E54656C65677261706820496E2074686520706173742C206174206C65617374206F6E6520626C6F636B206578706C6F7265720A004C50002020202020202020202077656273697465206661696C656420746F2071756F74652070726F7065726C792C2073656E64696E6720636F6465206469726563742066726F6D20636861696E20746F0A0016002020202020202020202062726F777365720A20200016000A20202020202020202020202020202020202020004C5000406164616D3375733A20226E6F206D616C77617265207468727520626C6F636B636861696E3B206A75737420706F73736962696C69747920636F6E6365726E73204B6173706572736B792220770A004C4F0020202020202020202020536E6F7764656E20726576656C6174696F6E732074686572652773203130303073206F662061637475616C207468696E677320746F20626520636F6E6365726E65640A0016002020202020202020202061626F75740A202020200016000A20202020202020202020202020202020202020004DF101A91435196ABEA2185D81B40892B05A3B9931E7E0445A88A914536A90579D91FE451729F9F4B3AC8A3536B24D9A88A9145BD392378038355E4CF6A89FE544322BF1D8ACF288A914896423801C19A68205D7A239D3938C9339603B6988A91435196ABEA2185D81B40892B05A3B9931E7E0445A88A9149836B22CF9B1B92EFD4D74F40411004C6A0B763988A9144AF51C7A087C0465AA8A825126EB69795E0AB59288A91479701B48D039881A01A2F0C2EDED9674E78E6C4288A91435196ABEA2185D81B40892B05A3B9931E7E0445A88A914AF3808E39C3E6C69DB4C338062F4CED63AF9B73288A91425C5CC51852C35FB3BD02CF70AF3645BF716A3E888A91435196ABEA2185D81B40892B05A3B9931E7E0445A88A91413D1001348F15D130DD32B40F2E2E56286CFF14588A9140EC7BD6EC488E83719CD96C1AF5E97943072F63488A9147714B064C38E98C7DFC39CE0A9DDC3B13D496E3688A91435196ABEA2185D81B40892B05A3B9931E7E0445A88A91481993F1209BB31390D7E3664904F60269880B1DF88A91498E5580712CC7CDA5F4326964EE1BF0B517014B488A914676308D94E23D7BA2C06ECC2261209F6E4F848E788A91435196ABEA2185D81B40892B05A3B9931E7E0445A882102FD832A11E82213C6B477FE2DB56D6F4D30CAADCBECE7D24770144A20509E950FAD0051FFFFFFFF9FA3F9993D2806D32D37C530A5BE530463FE8EF6E2D8D51C0BBAA73C4829EEC100000000EF48304502210091FABF70FB03AF43F9A514EA51B59B2097117A99490747CD5D1ED0BB289CD85302204DCA3470354845E763B3BCAEF8CC5F458048D59BF4C53AB7E78D9B8E2FE5131202390020202020202020202020202020202020496620736F2063616E2069742062652070726576656E7465643F20404E69636B537A61626F340A0016000A20202020202020202020202020202020202020004C53A91435196ABEA2185D81B40892B05A3B9931E7E0445A88A9144656E0C75A3CA4B0B54B2BF4847FF551409895C8882102FD832A11E82213C6B477FE2DB56D6F4D30CAADCBECE7D24770144A20509E950FAD5151FFFFFFFF01580200000000000017A914B472A266D0BD89C13706A4132CCFB16F7C3B9FCB8700000000";
        testConfig.transactionInputBytes = "9FA3F9993D2806D32D37C530A5BE530463FE8EF6E2D8D51C0BBAA73C4829EEC101000000FD250648304502210098B2ED4050360CB291A5F3986FF373384E85974AB3BC092FDA14E808737A5F6502207F9F8241EBE0BE6A1DE7F9C9F81CA232E02C97C4EC73E392B97461D33891A19E0216000A20202020202020202020202020202020202020004C4D0040436F696E54656C6567726170683A205761726E696E6721204B6173706572736B7920416C65727473205573657273206F66204D616C7761726520616E642027426C6F636B636861696E0A0043002020202020202020202020202020202041627573652720687474703A2F2F646C76722E69742F393837564E702020236D616C776172652023494E544552504F4C0A002D00202020202020202020202020202020207069632E747769747465722E636F6D2F4872304E536B36316E690A0016000A20202020202020202020202020202020202020004C4F00406164616D3375733A202E40436F696E54656C656772617068206D616B6573206E6F2073656E736520746F206D652E206F705F72657475726E206973206E6F742065786563757465642061730A004C4F0020202020202020202020636F646520627920616E792062726F777365723B206F705F72657475726E206D616B657320746865206D6F7374207573656C65737320766972757320766563746F720A00160020202020202020202020657665722E0A202020200016000A20202020202020202020202020202020202020004C520040636F6D6566726F6D6265796F6E643A20406164616D3375732040436F696E54656C656772617068205468657920736169642022626C6F636B636861696E222C206E6F742022426974636F696E222E0A001D00202020202020202020202020202020202023457468657265756D0A0016000A20202020202020202020202020202020202020004C4D00406A6761727A696B3A20406164616D3375732040436F696E54656C65677261706820496E2074686520706173742C206174206C65617374206F6E6520626C6F636B206578706C6F7265720A004C50002020202020202020202077656273697465206661696C656420746F2071756F74652070726F7065726C792C2073656E64696E6720636F6465206469726563742066726F6D20636861696E20746F0A0016002020202020202020202062726F777365720A20200016000A20202020202020202020202020202020202020004C5000406164616D3375733A20226E6F206D616C77617265207468727520626C6F636B636861696E3B206A75737420706F73736962696C69747920636F6E6365726E73204B6173706572736B792220770A004C4F0020202020202020202020536E6F7764656E20726576656C6174696F6E732074686572652773203130303073206F662061637475616C207468696E677320746F20626520636F6E6365726E65640A0016002020202020202020202061626F75740A202020200016000A20202020202020202020202020202020202020004DF101A91435196ABEA2185D81B40892B05A3B9931E7E0445A88A914536A90579D91FE451729F9F4B3AC8A3536B24D9A88A9145BD392378038355E4CF6A89FE544322BF1D8ACF288A914896423801C19A68205D7A239D3938C9339603B6988A91435196ABEA2185D81B40892B05A3B9931E7E0445A88A9149836B22CF9B1B92EFD4D74F40411004C6A0B763988A9144AF51C7A087C0465AA8A825126EB69795E0AB59288A91479701B48D039881A01A2F0C2EDED9674E78E6C4288A91435196ABEA2185D81B40892B05A3B9931E7E0445A88A914AF3808E39C3E6C69DB4C338062F4CED63AF9B73288A91425C5CC51852C35FB3BD02CF70AF3645BF716A3E888A91435196ABEA2185D81B40892B05A3B9931E7E0445A88A91413D1001348F15D130DD32B40F2E2E56286CFF14588A9140EC7BD6EC488E83719CD96C1AF5E97943072F63488A9147714B064C38E98C7DFC39CE0A9DDC3B13D496E3688A91435196ABEA2185D81B40892B05A3B9931E7E0445A88A91481993F1209BB31390D7E3664904F60269880B1DF88A91498E5580712CC7CDA5F4326964EE1BF0B517014B488A914676308D94E23D7BA2C06ECC2261209F6E4F848E788A91435196ABEA2185D81B40892B05A3B9931E7E0445A882102FD832A11E82213C6B477FE2DB56D6F4D30CAADCBECE7D24770144A20509E950FAD0051FFFFFFFF";
        testConfig.transactionOutputIndex = 1;
        testConfig.transactionOutputBytes = "954F0C000000000017A91433922DB2C52659F4EF2B579A1912D1D1ACDDDC9087";
        testConfig.blockHeight = 349598L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A91433922DB2C52659F4EF2B579A1912D1D1ACDDDC9087";
        testConfig.unlockingScriptBytes = "48304502210098B2ED4050360CB291A5F3986FF373384E85974AB3BC092FDA14E808737A5F6502207F9F8241EBE0BE6A1DE7F9C9F81CA232E02C97C4EC73E392B97461D33891A19E0216000A20202020202020202020202020202020202020004C4D0040436F696E54656C6567726170683A205761726E696E6721204B6173706572736B7920416C65727473205573657273206F66204D616C7761726520616E642027426C6F636B636861696E0A0043002020202020202020202020202020202041627573652720687474703A2F2F646C76722E69742F393837564E702020236D616C776172652023494E544552504F4C0A002D00202020202020202020202020202020207069632E747769747465722E636F6D2F4872304E536B36316E690A0016000A20202020202020202020202020202020202020004C4F00406164616D3375733A202E40436F696E54656C656772617068206D616B6573206E6F2073656E736520746F206D652E206F705F72657475726E206973206E6F742065786563757465642061730A004C4F0020202020202020202020636F646520627920616E792062726F777365723B206F705F72657475726E206D616B657320746865206D6F7374207573656C65737320766972757320766563746F720A00160020202020202020202020657665722E0A202020200016000A20202020202020202020202020202020202020004C520040636F6D6566726F6D6265796F6E643A20406164616D3375732040436F696E54656C656772617068205468657920736169642022626C6F636B636861696E222C206E6F742022426974636F696E222E0A001D00202020202020202020202020202020202023457468657265756D0A0016000A20202020202020202020202020202020202020004C4D00406A6761727A696B3A20406164616D3375732040436F696E54656C65677261706820496E2074686520706173742C206174206C65617374206F6E6520626C6F636B206578706C6F7265720A004C50002020202020202020202077656273697465206661696C656420746F2071756F74652070726F7065726C792C2073656E64696E6720636F6465206469726563742066726F6D20636861696E20746F0A0016002020202020202020202062726F777365720A20200016000A20202020202020202020202020202020202020004C5000406164616D3375733A20226E6F206D616C77617265207468727520626C6F636B636861696E3B206A75737420706F73736962696C69747920636F6E6365726E73204B6173706572736B792220770A004C4F0020202020202020202020536E6F7764656E20726576656C6174696F6E732074686572652773203130303073206F662061637475616C207468696E677320746F20626520636F6E6365726E65640A0016002020202020202020202061626F75740A202020200016000A20202020202020202020202020202020202020004DF101A91435196ABEA2185D81B40892B05A3B9931E7E0445A88A914536A90579D91FE451729F9F4B3AC8A3536B24D9A88A9145BD392378038355E4CF6A89FE544322BF1D8ACF288A914896423801C19A68205D7A239D3938C9339603B6988A91435196ABEA2185D81B40892B05A3B9931E7E0445A88A9149836B22CF9B1B92EFD4D74F40411004C6A0B763988A9144AF51C7A087C0465AA8A825126EB69795E0AB59288A91479701B48D039881A01A2F0C2EDED9674E78E6C4288A91435196ABEA2185D81B40892B05A3B9931E7E0445A88A914AF3808E39C3E6C69DB4C338062F4CED63AF9B73288A91425C5CC51852C35FB3BD02CF70AF3645BF716A3E888A91435196ABEA2185D81B40892B05A3B9931E7E0445A88A91413D1001348F15D130DD32B40F2E2E56286CFF14588A9140EC7BD6EC488E83719CD96C1AF5E97943072F63488A9147714B064C38E98C7DFC39CE0A9DDC3B13D496E3688A91435196ABEA2185D81B40892B05A3B9931E7E0445A88A91481993F1209BB31390D7E3664904F60269880B1DF88A91498E5580712CC7CDA5F4326964EE1BF0B517014B488A914676308D94E23D7BA2C06ECC2261209F6E4F848E788A91435196ABEA2185D81B40892B05A3B9931E7E0445A882102FD832A11E82213C6B477FE2DB56D6F4D30CAADCBECE7D24770144A20509E950FAD0051";

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_5C1254EC0372AD71300E805FC8C67C51DEB530D5D56C5FB4EF0CDB46F8E8F3CA_0() {
        // NOTE: This transaction's P2SH uses the first OP_0NOTEQUAL, which is a strange way of saying: IS_TRUE...

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "01000000019D3A2A0A7664CC276EE20D9068280FA16907678352A7879897312EB3EA80D22A00000000A90047304402206153ED3F399345EA34B07854A280018D2CEDABB7F520292691A6AC985DDB675F02207DBE548489F85B96B23A6BE79A1AC79957C4525738D05E3F28FF7F091C46E24E0141044F00551ADF0D9C3570C3A3385F0E3D41D7CC453A510F94666F45AADDF4E52314EFB873885FAB7364FCF0025912C8BDE866C8475761D910BFB97E527F484218CF1D76A914D653271A9F884276DC683440673D574BEC01C26088AC64929168FFFFFFFF0120BF0200000000001976A914D653271A9F884276DC683440673D574BEC01C26088AC00000000";
        testConfig.transactionInputBytes = "9D3A2A0A7664CC276EE20D9068280FA16907678352A7879897312EB3EA80D22A00000000A90047304402206153ED3F399345EA34B07854A280018D2CEDABB7F520292691A6AC985DDB675F02207DBE548489F85B96B23A6BE79A1AC79957C4525738D05E3F28FF7F091C46E24E0141044F00551ADF0D9C3570C3A3385F0E3D41D7CC453A510F94666F45AADDF4E52314EFB873885FAB7364FCF0025912C8BDE866C8475761D910BFB97E527F484218CF1D76A914D653271A9F884276DC683440673D574BEC01C26088AC64929168FFFFFFFF";
        testConfig.transactionOutputIndex = 0;
        testConfig.transactionOutputBytes = "30E602000000000017A914D528F0DA5CC8DF9C391F9F57EFC9A852AE37BC8287";
        testConfig.blockHeight = 351105L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A914D528F0DA5CC8DF9C391F9F57EFC9A852AE37BC8287";
        testConfig.unlockingScriptBytes = "0047304402206153ED3F399345EA34B07854A280018D2CEDABB7F520292691A6AC985DDB675F02207DBE548489F85B96B23A6BE79A1AC79957C4525738D05E3F28FF7F091C46E24E0141044F00551ADF0D9C3570C3A3385F0E3D41D7CC453A510F94666F45AADDF4E52314EFB873885FAB7364FCF0025912C8BDE866C8475761D910BFB97E527F484218CF1D76A914D653271A9F884276DC683440673D574BEC01C26088AC64929168";

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_2AEA09C8441805428294F8A98023E8CD7BB2C3543B1F38435B526B700E319586_0() {
        // NOTE: This transaction uses a nested IF, where the outer condition is false causing the inner if/else to not be evaluated.

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "010000000154556BA68C1584FB404C1C0B593A3170601191D31E832C0F1B5C006B6679F60000000000FD3F010047304402204EC263537B12BBF32367ED1B8058E10728F8CEADA23B44A727F68256847EBF2D02204B479E1899FF7B68487A7F2C946424DE717CE6725E614DB6CC191C206A496B8B01483045022100E2FC70C6CFE7066E0E15707471A0396627E75E816DDC4F552F778C6018620D9402205A705071F237943698DB381BB2040F8044A468612451C219CCD5F4E0D36FAF9401004CAA636376A820C775E7B757EDE630CD0AA1113BD102661AB38829CA52A6422AB782862F268646877576A914937FE2EE82229D282EDEC2606C70E755875334C088AC6703C8F505B17576A91420FBF78BA8F2F36FEAEC0EFC5B82D5E07FB261A988AC68675221021844989A2BD7ACD127DD7ED51AA2F4D55B32DBB414DE6325AE37E05C1067598D2103D7C6052544BC42EB2BC0D27C884016ADB933F15576A1A2D21CD4DD0F2DE0C37D52AE68FFFFFFFF0110270000000000001976A914937FE2EE82229D282EDEC2606C70E755875334C088AC00000000";
        testConfig.transactionInputBytes = "54556BA68C1584FB404C1C0B593A3170601191D31E832C0F1B5C006B6679F60000000000FD3F010047304402204EC263537B12BBF32367ED1B8058E10728F8CEADA23B44A727F68256847EBF2D02204B479E1899FF7B68487A7F2C946424DE717CE6725E614DB6CC191C206A496B8B01483045022100E2FC70C6CFE7066E0E15707471A0396627E75E816DDC4F552F778C6018620D9402205A705071F237943698DB381BB2040F8044A468612451C219CCD5F4E0D36FAF9401004CAA636376A820C775E7B757EDE630CD0AA1113BD102661AB38829CA52A6422AB782862F268646877576A914937FE2EE82229D282EDEC2606C70E755875334C088AC6703C8F505B17576A91420FBF78BA8F2F36FEAEC0EFC5B82D5E07FB261A988AC68675221021844989A2BD7ACD127DD7ED51AA2F4D55B32DBB414DE6325AE37E05C1067598D2103D7C6052544BC42EB2BC0D27C884016ADB933F15576A1A2D21CD4DD0F2DE0C37D52AE68FFFFFFFF";
        testConfig.transactionOutputIndex = 0;
        testConfig.transactionOutputBytes = "204E00000000000017A914C45CAF0CDCE1B9BD934930FA67C9846635CEFF2887";
        testConfig.blockHeight = 391129L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A914C45CAF0CDCE1B9BD934930FA67C9846635CEFF2887";
        testConfig.unlockingScriptBytes = "0047304402204EC263537B12BBF32367ED1B8058E10728F8CEADA23B44A727F68256847EBF2D02204B479E1899FF7B68487A7F2C946424DE717CE6725E614DB6CC191C206A496B8B01483045022100E2FC70C6CFE7066E0E15707471A0396627E75E816DDC4F552F778C6018620D9402205A705071F237943698DB381BB2040F8044A468612451C219CCD5F4E0D36FAF9401004CAA636376A820C775E7B757EDE630CD0AA1113BD102661AB38829CA52A6422AB782862F268646877576A914937FE2EE82229D282EDEC2606C70E755875334C088AC6703C8F505B17576A91420FBF78BA8F2F36FEAEC0EFC5B82D5E07FB261A988AC68675221021844989A2BD7ACD127DD7ED51AA2F4D55B32DBB414DE6325AE37E05C1067598D2103D7C6052544BC42EB2BC0D27C884016ADB933F15576A1A2D21CD4DD0F2DE0C37D52AE68";

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_7EAC45ADE99281C1458ACA234F2EA260FEE9075065D260B0D3118DF8BD2FEDF3_0() {
        // NOTE: This transaction is one of the first OP_CHECKLOCKTIMEVERIFY transactions.

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "010000000168317EC8ECAEE38C03A21939DDE22622B37C0FB6D135FA3C3F9D2DA71374AB3D0100000073483045022100B2E827D892BE74E00A7D499244E6FC2EC392BA2C6DC7C72BBD99F31865D346450220612182F6BB99B7AEC87E82945243B86F327411C3D1F3A6A2ABF6BD1317C584AF0129034DED05B17521038CD6DB60CB937555DCD30D6F927A3E4EE0F631E8EAF1C61C76C40804FFA3EDD4AC000000000194BB00000000000017A914F1F4FB78C04FE29032192919B3D90C6A5CCADDAB874DED0500";
        testConfig.transactionInputBytes = "68317EC8ECAEE38C03A21939DDE22622B37C0FB6D135FA3C3F9D2DA71374AB3D0100000073483045022100B2E827D892BE74E00A7D499244E6FC2EC392BA2C6DC7C72BBD99F31865D346450220612182F6BB99B7AEC87E82945243B86F327411C3D1F3A6A2ABF6BD1317C584AF0129034DED05B17521038CD6DB60CB937555DCD30D6F927A3E4EE0F631E8EAF1C61C76C40804FFA3EDD4AC00000000";
        testConfig.transactionOutputIndex = 1;
        testConfig.transactionOutputBytes = "50C300000000000017A914F1F4FB78C04FE29032192919B3D90C6A5CCADDAB87";
        testConfig.blockHeight = 388432L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A914F1F4FB78C04FE29032192919B3D90C6A5CCADDAB87";
        testConfig.unlockingScriptBytes = "483045022100B2E827D892BE74E00A7D499244E6FC2EC392BA2C6DC7C72BBD99F31865D346450220612182F6BB99B7AEC87E82945243B86F327411C3D1F3A6A2ABF6BD1317C584AF0129034DED05B17521038CD6DB60CB937555DCD30D6F927A3E4EE0F631E8EAF1C61C76C40804FFA3EDD4AC";

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_C16ADEA5B0662190760CE125ECFD3AB65BFD971303CC64031F9BCC173EBFDF4B_0() {
        // NOTE: This transaction is one of the first OP_CHECKLOCKTIMEVERIFY transactions.

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "010000000148F4667CB2C64552504B55A57E878683B771EDFAACEB03C47A92894C68BD6C4F010000007347304402201E0A53D6C968152B7CEDB76EF4D0E18C7D9894335A8929547B4FC813857FE1EC02204F771A405DB3112B5D2F6DB3BEC08B800F66297CC60FE17DDDDC6C2593F267DE012A045D686F56B175210395EFBC79D9E3635FEFE1C1AB821047149DA7FB7DBEB32969500058CCCABCB0CFAC0000000001E0570100000000001976A9141DE54DB01724BB0C84B1B5B19DE55DFEF530C0ED88AC5D686F56";
        testConfig.transactionInputBytes = "48F4667CB2C64552504B55A57E878683B771EDFAACEB03C47A92894C68BD6C4F010000007347304402201E0A53D6C968152B7CEDB76EF4D0E18C7D9894335A8929547B4FC813857FE1EC02204F771A405DB3112B5D2F6DB3BEC08B800F66297CC60FE17DDDDC6C2593F267DE012A045D686F56B175210395EFBC79D9E3635FEFE1C1AB821047149DA7FB7DBEB32969500058CCCABCB0CFAC00000000";
        testConfig.transactionOutputIndex = 1;
        testConfig.transactionOutputBytes = "A08601000000000017A9142997379B5193640D415EBF7587D33838216D1C3687";
        testConfig.blockHeight = 388456L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A9142997379B5193640D415EBF7587D33838216D1C3687";
        testConfig.unlockingScriptBytes = "47304402201E0A53D6C968152B7CEDB76EF4D0E18C7D9894335A8929547B4FC813857FE1EC02204F771A405DB3112B5D2F6DB3BEC08B800F66297CC60FE17DDDDC6C2593F267DE012A045D686F56B175210395EFBC79D9E3635FEFE1C1AB821047149DA7FB7DBEB32969500058CCCABCB0CFAC";

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_892F44A49DE6F5B212CDBEA514D09E692D9FED5D897F37BCEF14BD0EEDEBF193_0() {
        // NOTE: This transaction is the first enabled CHECK_SEQUENCE_NUMBER_THEN_VERIFY transaction.

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "0200000001DEB98691723FA71260FFCA6EA0A7BC0A63B0A8A366E1B585CAAD47FB269A2CE401000000030251B201000000010000000000000000016A00000000";
        testConfig.transactionInputBytes = "DEB98691723FA71260FFCA6EA0A7BC0A63B0A8A366E1B585CAAD47FB269A2CE401000000030251B201000000";
        testConfig.transactionOutputIndex = 1;
        testConfig.transactionOutputBytes = "A08601000000000017A9147C17AFF532F22BEB54069942F9BF567A66133EAF87";
        testConfig.blockHeight = 419462L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A9147C17AFF532F22BEB54069942F9BF567A66133EAF87";
        testConfig.unlockingScriptBytes = "0251B2";

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_54AED2D3ABC9B7F6337272649A8B61B774415D469CED1C218F8780BD644C02ED() {
        // NOTE: This transaction's LockTime failed to validate.  However, its lockTime should be ignored since all of its inputs' SequenceNumbers are "final"...

        // Setup
        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "0100000001FEF8D1C268874475E874A2A3A664A4EB6F98D1D258B62A2800E4BEFA069C57AD010000008B483045022100B482783530D3EC73C97A5DC147EE3CF1705E355C17DD9DF7AD30D8E49712260D022059750222B33F45D80F5DC49C732786EBAED6C6FA72162A4632FEA7231339C15C0141045D443089B4587D355B4CB5AC39B0156AFC92152627693149DE16D0D2269CEA2417010C0BC6930E9B47573DAB76A951E01D884B2BED9EAF92CC2369B6DDC7F98CFFFFFFFF0200000000000000000B6A0942454E2072756C657A306F0100000000001976A9147038DC3B8533A422D1225ECBCC3C85E282FD92B388ACE4670600";
        testConfig.blockHeight = 419808L;
        testConfig.transactionInputIndex = 0; // Defined for init, but unused.

        final UpgradeSchedule upgradeSchedule = new FakeUpgradeSchedule(new CoreUpgradeSchedule());
        final TransactionContext transactionContext = HistoricTransactionsTests.initContext(testConfig, (Map<Sha256Hash, Transaction>) null, upgradeSchedule);

        final MedianBlockTime medianBlockTime = ImmutableMedianBlockTime.fromSeconds(1467969398L);
        final VolatileNetworkTime networkTime = VolatileNetworkTimeWrapper.wrap(ImmutableNetworkTime.fromSeconds(1529680230L));

        final FakeMedianBlockTimeContext medianBlockTimeContext = new FakeMedianBlockTimeContext();
        medianBlockTimeContext.setMedianBlockTime(testConfig.blockHeight, medianBlockTime);

        final TransactionValidatorCore transactionValidator = new TransactionValidatorCore(upgradeSchedule, null, networkTime, null);

        // Action
        final Boolean shouldValidateLockTime = transactionValidator._shouldValidateLockTime(transactionContext.getTransaction());

        // Assert
        Assert.assertFalse(shouldValidateLockTime);
    }

    @Test
    public void should_verify_transaction_5FEC539B26083B26D9D77014402E5942566A3C8C6E1B2B0C9CD245D51A0A5C61_0() {
        // NOTE: This transaction is dependent upon having OP_CODESEPARATORS removed from its redeemScript...

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "01000000016AAA18F4AB91FAB80ECDA666C4DEF68B8B75CC6BB1169ECD81716EAB03FF14D007000000FD8701483045022100AC4319CF798AB10D864AD5F206CD405B7A15957EEF2B0094AB24FFCF2C28FBFB022012053C8142D9E4F832D85C6CE7DBA82D44D011C7713FB584771FB8770DA97C0C012102C8662AAA171B5C98FEF66C02138165F600C7C5743380686958E395EDF8EB36BF47304402202FEEDC3B54CD87868406E93EE650742B61CE39162D70B6FDE5A805FD40A56C900220015970A2FC874C32EDFCD6341981D35E5B019A14B17662E00F49E363DB72B93C014CD22102FB6827937707BF432D85B094BC180AB93394EE013B3ECAAFA04B9135E3AB6E50AD74926404162C5658B15167762103DB22E387923AD0552E1C4A4355324313AF85926D4266C0EAA86F02EB1E01B2D28763AC67762102C8662AAA171B5C98FEF66C02138165F600C7C5743380686958E395EDF8EB36BF886E6B6B0064AB05636F6E643175AC687664756C6C6E6B6BAB05636F6E643275AC687664756C6C6E6B6BAB05636F6E643375AC687664756C6C6E6B6BAB05636F6E643475AC687664756C6C6E6B6BAB05636F6E643575AC686868FFFFFFFF01204E0000000000001976A914648A4310B84426F426398EF27E3388A4D2C05A2888AC342C5658";
        testConfig.transactionInputBytes = "6AAA18F4AB91FAB80ECDA666C4DEF68B8B75CC6BB1169ECD81716EAB03FF14D007000000FD8701483045022100AC4319CF798AB10D864AD5F206CD405B7A15957EEF2B0094AB24FFCF2C28FBFB022012053C8142D9E4F832D85C6CE7DBA82D44D011C7713FB584771FB8770DA97C0C012102C8662AAA171B5C98FEF66C02138165F600C7C5743380686958E395EDF8EB36BF47304402202FEEDC3B54CD87868406E93EE650742B61CE39162D70B6FDE5A805FD40A56C900220015970A2FC874C32EDFCD6341981D35E5B019A14B17662E00F49E363DB72B93C014CD22102FB6827937707BF432D85B094BC180AB93394EE013B3ECAAFA04B9135E3AB6E50AD74926404162C5658B15167762103DB22E387923AD0552E1C4A4355324313AF85926D4266C0EAA86F02EB1E01B2D28763AC67762102C8662AAA171B5C98FEF66C02138165F600C7C5743380686958E395EDF8EB36BF886E6B6B0064AB05636F6E643175AC687664756C6C6E6B6BAB05636F6E643275AC687664756C6C6E6B6BAB05636F6E643375AC687664756C6C6E6B6BAB05636F6E643475AC687664756C6C6E6B6BAB05636F6E643575AC686868FFFFFFFF";
        testConfig.transactionOutputIndex = 7;
        testConfig.transactionOutputBytes = "701101000000000017A9143AE52DBC43C884EF43211A43082D01A0091EF1E387";
        testConfig.blockHeight = 443992L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A9143AE52DBC43C884EF43211A43082D01A0091EF1E387";
        testConfig.unlockingScriptBytes = "483045022100AC4319CF798AB10D864AD5F206CD405B7A15957EEF2B0094AB24FFCF2C28FBFB022012053C8142D9E4F832D85C6CE7DBA82D44D011C7713FB584771FB8770DA97C0C012102C8662AAA171B5C98FEF66C02138165F600C7C5743380686958E395EDF8EB36BF47304402202FEEDC3B54CD87868406E93EE650742B61CE39162D70B6FDE5A805FD40A56C900220015970A2FC874C32EDFCD6341981D35E5B019A14B17662E00F49E363DB72B93C014CD22102FB6827937707BF432D85B094BC180AB93394EE013B3ECAAFA04B9135E3AB6E50AD74926404162C5658B15167762103DB22E387923AD0552E1C4A4355324313AF85926D4266C0EAA86F02EB1E01B2D28763AC67762102C8662AAA171B5C98FEF66C02138165F600C7C5743380686958E395EDF8EB36BF886E6B6B0064AB05636F6E643175AC687664756C6C6E6B6BAB05636F6E643275AC687664756C6C6E6B6BAB05636F6E643375AC687664756C6C6E6B6BAB05636F6E643475AC687664756C6C6E6B6BAB05636F6E643575AC686868";

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_DFF40F79CEF322369D1D7AB9DC20F71A75DD333DC30EB2D77C08DAFDBD1A7E86_0() {
        // NOTE: This is a transaction included in the first Bitcoin Cash block. It has a different transaction signature hashing algorithm...

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "0200000001A81CDA1AAA250C43B2B5A7E782898D6B41EB1638C3042EF39B139280FB9E47FE000000006B483045022100CD990173DED4ABE8761E28F1FB31FC395434C49A7B90E3B4BEBCC79F988C91EC02206783B794ADA488A11A8B694EC129D863EBECBF9646C1E5B55F16652F1FF069E541210304143552E66475C8500C8A54565A4FB2C8586C9861C6FFA63D402BBBC54ACA64FFFFFFFF0280969800000000001976A91408C82CB3A87AA92967E2F4DEC86F97F5B84CF11288AC24773B05000000001976A91427C8CE6010408CC9B9AE36BF5378A9BFB24BB45088AC00000000";
        testConfig.transactionInputBytes = "A81CDA1AAA250C43B2B5A7E782898D6B41EB1638C3042EF39B139280FB9E47FE000000006B483045022100CD990173DED4ABE8761E28F1FB31FC395434C49A7B90E3B4BEBCC79F988C91EC02206783B794ADA488A11A8B694EC129D863EBECBF9646C1E5B55F16652F1FF069E541210304143552E66475C8500C8A54565A4FB2C8586C9861C6FFA63D402BBBC54ACA64FFFFFFFF";
        testConfig.transactionOutputIndex = 0;
        testConfig.transactionOutputBytes = "00E1F505000000001976A9145638F9A56D28AAD91177A1B545F394EF4255459A88AC";
        testConfig.blockHeight = 478559L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "76A9145638F9A56D28AAD91177A1B545F394EF4255459A88AC";
        testConfig.unlockingScriptBytes = "483045022100CD990173DED4ABE8761E28F1FB31FC395434C49A7B90E3B4BEBCC79F988C91EC02206783B794ADA488A11A8B694EC129D863EBECBF9646C1E5B55F16652F1FF069E541210304143552E66475C8500C8A54565A4FB2C8586C9861C6FFA63D402BBBC54ACA64";

        // Median Block Time:	1501591048
        // Network Time:		1534795151

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_A799F7599DF6A6A1CF5A00ECF18F1FB8FBC09F496F787776BBD0B12FE1A347B1_0() {
        // NOTE: This is a transaction included in the first Bitcoin Cash block. It has a different transaction signature hashing algorithm...

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "02000000017435AF4428E056A31F9F0770F6EFD51E436F4C4A2656C6DE26CD899E91FB7CCF980000006A47304402207355974732A5FF208ECE92948A4B3F4EADF92E24C3BF09F4D137541F309C18D502207A73DCBD83E909F6CF25BB17C8744A3167FF159D04371034EA62632926317E08412103E634ADE750834E03E8FD378956562ED39DB8C7B9B3DB8C43A1DB32A41DAD00E2FFFFFFFF02905F0100000000001976A914D4DE1D3A25C6AAF06F619534F9E5849BD0F132C788ACA0860100000000001976A9142C3D0D50A098DF240D725CFBF4D82E04E42FCB5F88AC00000000";
        testConfig.transactionInputBytes = "7435AF4428E056A31F9F0770F6EFD51E436F4C4A2656C6DE26CD899E91FB7CCF980000006A47304402207355974732A5FF208ECE92948A4B3F4EADF92E24C3BF09F4D137541F309C18D502207A73DCBD83E909F6CF25BB17C8744A3167FF159D04371034EA62632926317E08412103E634ADE750834E03E8FD378956562ED39DB8C7B9B3DB8C43A1DB32A41DAD00E2FFFFFFFF";
        testConfig.transactionOutputIndex = 152;
        testConfig.transactionOutputBytes = "400D0300000000001976A91433345F36287BF3BF7FBC3A30FA4E74C99064851788AC";
        testConfig.blockHeight = 478559L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "76A91433345F36287BF3BF7FBC3A30FA4E74C99064851788AC";
        testConfig.unlockingScriptBytes = "47304402207355974732A5FF208ECE92948A4B3F4EADF92E24C3BF09F4D137541F309C18D502207A73DCBD83E909F6CF25BB17C8744A3167FF159D04371034EA62632926317E08412103E634ADE750834E03E8FD378956562ED39DB8C7B9B3DB8C43A1DB32A41DAD00E2";

        // Median Block Time:	1501591048
        // Network Time:		1534795151

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_9E473B2B5BFAD6CAD44CC8FF4E1C96E8D1564962DF58C8D6183ACF091EC8437D_0() {
        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "01000000028DF34B1E41F0980D692685D35F0EAF23999313F8EEBE48DB393FCB2A32BEF39F000000006B4830450221009DC7142F20C50270E5568EB2CE99F27704265730EE24F4994CD24A74B9930A7F02204CA57F8BD2438873EC831C7349D709D53BD77B148A8A1861531FCCAE361DBA17C12103E0521DC396223E46032DC041CC78FDC70D46DAF6BE90A7DE088A50CB4F10379AFFFFFFFF1AE2A56F7DD5096439D8CF5E25D3F9BCFE7E1B37F592E792BC8EBE38586EA184000000006B483045022100DE4139B6788D935837AD0125202891654813CDDCC00D977C72333CE19CFE73F802207D1E2E92BD729C1D9F288FF123DEE6D8AEE59A6F7A033447965669210B7AA42FC12103CD6FE8B2E0B0807BB39C3D19151DB5035AC22D28E7C3FF0CBA73846D2D54079DFFFFFFFF0160B74700000000001976A9148CAA5C4DEF62E839F92B124F3F857B69C819581988AC00000000";
        testConfig.transactionInputBytes = "8DF34B1E41F0980D692685D35F0EAF23999313F8EEBE48DB393FCB2A32BEF39F000000006B4830450221009DC7142F20C50270E5568EB2CE99F27704265730EE24F4994CD24A74B9930A7F02204CA57F8BD2438873EC831C7349D709D53BD77B148A8A1861531FCCAE361DBA17C12103E0521DC396223E46032DC041CC78FDC70D46DAF6BE90A7DE088A50CB4F10379AFFFFFFFF";
        testConfig.transactionOutputIndex = 0;
        testConfig.transactionOutputBytes = "80234300000000001976A914CDD9EA901AAEB786826FFA4EFBE763A83F32E0B288AC";
        testConfig.blockHeight = 505453L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "76A914CDD9EA901AAEB786826FFA4EFBE763A83F32E0B288AC";
        testConfig.unlockingScriptBytes = "4830450221009DC7142F20C50270E5568EB2CE99F27704265730EE24F4994CD24A74B9930A7F02204CA57F8BD2438873EC831C7349D709D53BD77B148A8A1861531FCCAE361DBA17C12103E0521DC396223E46032DC041CC78FDC70D46DAF6BE90A7DE088A50CB4F10379A";

        // Median Block Time:   1511446264
        // Network Time:        1535588492

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_C7567DD7543C8E159A9E541BAB0451C47A6B266D34C55143066034EB579A8B19_0() {
        // NOTE: This transaction uses OP_SPLIT...

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "010000000175D0502456B2DF9F62168D542D8C0A26426855050CC870F550FEC9A67745DC91000000006D20C217E46529CB1E14DE7DE7B946218C909C2BB496190BEA532F9C7FED15C6635F4B76607F7C10C217E46529CB1E14DE7DE7B946218C908875AA8255947F0501FFFFFF0084636A6751687451A0637C757451A0637C757451A0637C757451A0637C757451A0637C756868686868FFFFFFFF01204A0000000000001976A91433759D937750A791876B1781B6BC919E54B8CE8088AC00000000";
        testConfig.transactionInputBytes = "75D0502456B2DF9F62168D542D8C0A26426855050CC870F550FEC9A67745DC91000000006D20C217E46529CB1E14DE7DE7B946218C909C2BB496190BEA532F9C7FED15C6635F4B76607F7C10C217E46529CB1E14DE7DE7B946218C908875AA8255947F0501FFFFFF0084636A6751687451A0637C757451A0637C757451A0637C757451A0637C757451A0637C756868686868FFFFFFFF";
        testConfig.transactionOutputIndex = 0;
        testConfig.transactionOutputBytes = "1B4B00000000000017A914502B80B20F69D2E8DAB7A41F0B6104FEF532445187";
        testConfig.blockHeight = 530359L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A914502B80B20F69D2E8DAB7A41F0B6104FEF532445187";
        testConfig.unlockingScriptBytes = "20C217E46529CB1E14DE7DE7B946218C909C2BB496190BEA532F9C7FED15C6635F4B76607F7C10C217E46529CB1E14DE7DE7B946218C908875AA8255947F0501FFFFFF0084636A6751687451A0637C757451A0637C757451A0637C757451A0637C757451A0637C756868686868";

        // Median Block Time:   1526405239
        // Network Time:        1535866291

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_FBB2CBE350E9DDD6FC3CBA1A4C721DEB87083FC238DA40C8D63FA3011D99CFE9_0() {
        // NOTE: This transaction uses ENCODE_NUMBER...

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "0200000001AED8BB86DD133D96AB93C2517B1A25C23B7D614F607C8F61B0E9B549A5D3878C000000001615008181818181818181818181818181818181810087FFFFFFFF0120680000000000001976A914F3CEA45002302FB8D7AFE0BAF3CC41F0D5EF759488AC00000000";
        testConfig.transactionInputBytes = "AED8BB86DD133D96AB93C2517B1A25C23B7D614F607C8F61B0E9B549A5D3878C000000001615008181818181818181818181818181818181810087FFFFFFFF";
        testConfig.transactionOutputIndex = 0;
        testConfig.transactionOutputBytes = "A87B00000000000017A914A8C94BC7A012435D49BBD1398676CE65BD82CD4087";
        testConfig.blockHeight = 530360L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A914A8C94BC7A012435D49BBD1398676CE65BD82CD4087";
        testConfig.unlockingScriptBytes = "15008181818181818181818181818181818181810087";

        // Median Block Time:   1526405443
        // Network Time:        1535945129

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_4D15FB22E756A7D8B301226C73BABFE3E5BAD3C635F22D644F148FD10B6AD019_0() {
        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "01000000014C226A81CD9683AF8E6970D392668A6186369138765DB13ABD0558A12DA63170000000002C2B02800081028000877451A0637C757451A0637C757451A0637C757451A0637C757451A0637C756868686868FFFFFFFF012DAC0000000000001976A91483AC2AD06B384EE850578081FE6398B9355865C288AC00000000";
        testConfig.transactionInputBytes = "4C226A81CD9683AF8E6970D392668A6186369138765DB13ABD0558A12DA63170000000002C2B02800081028000877451A0637C757451A0637C757451A0637C757451A0637C757451A0637C756868686868FFFFFFFF";
        testConfig.transactionOutputIndex = 0;
        testConfig.transactionOutputBytes = "75B900000000000017A91415D865E0111B14CA9BA80DCE45E0F3671E9AFF8E87";
        testConfig.blockHeight = 530449L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A91415D865E0111B14CA9BA80DCE45E0F3671E9AFF8E87";
        testConfig.unlockingScriptBytes = "2B02800081028000877451A0637C757451A0637C757451A0637C757451A0637C757451A0637C756868686868";

        // Median Block Time:   1526468704
        // Network Time:        1535947336

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_B5782D98475650A12A74AC87309242F00290DCA3FEDECF07031CC0F847FE59F0_0() {
        // NOTE: This transaction uses NUMBER_TO_BYTES...

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "01000000011B7878047A8353E9224617B153BF93A96B3437C299C02CFDED25832AEE1CE2B7000000002A290180008000877451A0637C757451A0637C757451A0637C757451A0637C757451A0637C756868686868FFFFFFFF0131AC0000000000001976A91483AC2AD06B384EE850578081FE6398B9355865C288AC00000000";
        testConfig.transactionInputBytes = "1B7878047A8353E9224617B153BF93A96B3437C299C02CFDED25832AEE1CE2B7000000002A290180008000877451A0637C757451A0637C757451A0637C757451A0637C757451A0637C756868686868FFFFFFFF";
        testConfig.transactionOutputIndex = 0;
        testConfig.transactionOutputBytes = "75B900000000000017A914D4503BAF026BF3368517E3EBCCCB4E64824B38EA87";
        testConfig.blockHeight = 530449L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A914D4503BAF026BF3368517E3EBCCCB4E64824B38EA87";
        testConfig.unlockingScriptBytes = "290180008000877451A0637C757451A0637C757451A0637C757451A0637C757451A0637C756868686868";

        // Median Block Time:   1526468704
        // Network Time:        1535947336

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_0C72F68D11847E1594CBC327DE1DBB92E342CD0A918D349E144442C65ACE2AC5_0() {
        // NOTE: This transaction uses NUMBER_TO_BYTES...

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "0100000001730548D29ED935DC194A22CA00EFC7AB36795DF077BF7573C8D0FA9B5D024A33000000002C2B01AA5280022A80877451A0637C757451A0637C757451A0637C757451A0637C757451A0637C756868686868FFFFFFFF012DAC0000000000001976A91483AC2AD06B384EE850578081FE6398B9355865C288AC00000000";
        testConfig.transactionInputBytes = "730548D29ED935DC194A22CA00EFC7AB36795DF077BF7573C8D0FA9B5D024A33000000002C2B01AA5280022A80877451A0637C757451A0637C757451A0637C757451A0637C757451A0637C756868686868FFFFFFFF";
        testConfig.transactionOutputIndex = 0;
        testConfig.transactionOutputBytes = "75B900000000000017A9143CD7A0F95C29BA09D9389F857656E8229F0BEEBF87";
        testConfig.blockHeight = 530449L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A9143CD7A0F95C29BA09D9389F857656E8229F0BEEBF87";
        testConfig.unlockingScriptBytes = "2B01AA5280022A80877451A0637C757451A0637C757451A0637C757451A0637C757451A0637C756868686868";

        // Median Block Time:   1526468704
        // Network Time:        1535947336

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_7D5EE5B17FC82CE9B6CBD1C6C76B31773DEAA8945140072512BFF811C99F1E92_0() {
        // NOTE: This transaction uses NUMBER_TO_BYTES...

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "01000000019CE5834F9E3694606CC7F961AE6C7CE6F51BD8723685F6263DF3EC08CC39AC6B00000000323105ABCDEF4280548004ABCDEFC2877451A0637C757451A0637C757451A0637C757451A0637C757451A0637C756868686868FFFFFFFF0121AC0000000000001976A91483AC2AD06B384EE850578081FE6398B9355865C288AC00000000";
        testConfig.transactionInputBytes = "9CE5834F9E3694606CC7F961AE6C7CE6F51BD8723685F6263DF3EC08CC39AC6B00000000323105ABCDEF4280548004ABCDEFC2877451A0637C757451A0637C757451A0637C757451A0637C757451A0637C756868686868FFFFFFFF";
        testConfig.transactionOutputIndex = 0;
        testConfig.transactionOutputBytes = "75B900000000000017A91464902B04C3D9EA558B7F2EDB24758B383343A2D587";
        testConfig.blockHeight = 530449L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A91464902B04C3D9EA558B7F2EDB24758B383343A2D587";
        testConfig.unlockingScriptBytes = "3105ABCDEF4280548004ABCDEFC2877451A0637C757451A0637C757451A0637C757451A0637C757451A0637C756868686868";

        // Median Block Time:   1526468704
        // Network Time:        1535947336

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_75F53EADFADFC1C01E3FFC5325BD8E1F3D138AA61ABC5384CD16258EBBDB17D8_0() {
        // NOTE: This transaction has an undefined ("NON_OP"/"OP_INVALID") operation in an unexecuted branch... After conferring with BitcoinXT, this is allowed.

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "0100000002C47AE514A2951A2F79CBE2426C7FD01346776E326430E93F98A8E4D068F990BC00000000FDFE004730440220251DD17AE8E8296D42DC6F78982FC50ED8CA110A77BBF6BD6D8290273BD2885A02201CA724CB59AE2F22CDDD35A8C31490DF59979C1CF29AC5B081D837504800030A41004CB3634630440220256C12175E809381F97637933ED6AB97737D263EAAEBCA6ADD21BCED67FD12A402205CE29ECC1369D6FC1B51977ED38FAAF41119E3BE1D7EDFAFD7CFAF0B6061BD070021038282263212C609D9EA2A6E3E172DE238D8C39CABD5AC1CA10646E23FD5F51508BB210251B7565984B302D3F2BB9B2D8A2E5FD93CCF2B031B4B81976999D174889799AA672102FB4EE38EC29D417C6A99CF9BE08BFD57858683DFB7E8FC32F50775EC4D1E089768ACFFFFFFFFC47AE514A2951A2F79CBE2426C7FD01346776E326430E93F98A8E4D068F990BC010000006A473044022033325FFAFEA48270B41E66784295FDB99CBFF08676CA21B2D576D61D5DED6E9402203EB259EC63966D4A11373F39F98D47A797E21403B84C7532319FFD9E438E1DF14121022629BADE082C981A7608A3D4D6826FA83C0A9C4ECB1D62D203744C75FF931D07FEFFFFFF01B2F70000000000001976A91439BF9061BB1039AAD8F540F184D0CBC4DB0FBB7688AC00000000";
        testConfig.transactionInputBytes = "C47AE514A2951A2F79CBE2426C7FD01346776E326430E93F98A8E4D068F990BC00000000FDFE004730440220251DD17AE8E8296D42DC6F78982FC50ED8CA110A77BBF6BD6D8290273BD2885A02201CA724CB59AE2F22CDDD35A8C31490DF59979C1CF29AC5B081D837504800030A41004CB3634630440220256C12175E809381F97637933ED6AB97737D263EAAEBCA6ADD21BCED67FD12A402205CE29ECC1369D6FC1B51977ED38FAAF41119E3BE1D7EDFAFD7CFAF0B6061BD070021038282263212C609D9EA2A6E3E172DE238D8C39CABD5AC1CA10646E23FD5F51508BB210251B7565984B302D3F2BB9B2D8A2E5FD93CCF2B031B4B81976999D174889799AA672102FB4EE38EC29D417C6A99CF9BE08BFD57858683DFB7E8FC32F50775EC4D1E089768ACFFFFFFFF";
        testConfig.transactionOutputIndex = 0;
        testConfig.transactionOutputBytes = "E80300000000000017A9144CA7A737DD159455E126FA555035F5EC02EC341987";
        testConfig.blockHeight = 554413L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A9144CA7A737DD159455E126FA555035F5EC02EC341987";
        testConfig.unlockingScriptBytes = "4730440220251DD17AE8E8296D42DC6F78982FC50ED8CA110A77BBF6BD6D8290273BD2885A02201CA724CB59AE2F22CDDD35A8C31490DF59979C1CF29AC5B081D837504800030A41004CB3634630440220256C12175E809381F97637933ED6AB97737D263EAAEBCA6ADD21BCED67FD12A402205CE29ECC1369D6FC1B51977ED38FAAF41119E3BE1D7EDFAFD7CFAF0B6061BD070021038282263212C609D9EA2A6E3E172DE238D8C39CABD5AC1CA10646E23FD5F51508BB210251B7565984B302D3F2BB9B2D8A2E5FD93CCF2B031B4B81976999D174889799AA672102FB4EE38EC29D417C6A99CF9BE08BFD57858683DFB7E8FC32F50775EC4D1E089768AC";

        // Median Block Time:   1540883400
        // Network Time:        1540952890

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_00000007EA9E758EFA25F8054EA5F1C42A1555AD5B4731FF356C0254DD91718F_0() {
        // NOTE: This transaction uses OP_CHECKDATASIG, whose signature is an empty byte array.

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "0100000001415C13DA71B173B437F46D9283FBB19EEEC15F1153DA5DD620737F70BE08BB3C00000000A2483045022100C3435528DF9903D71A0A2202A717A3936839769A789D565F4823B3CC1E7C193302204DBC62ADA3EA2253FA854FBABC44A03E7297E1D77ACD640DE78C3132E2018E4D414C57000E636F696E7371756172652E636F6D21023026E4459353C8AE361D4A467C75EFCE28B4CB2E49F44CA8BC4357B47E197A0BBA7521023026E4459353C8AE361D4A467C75EFCE28B4CB2E49F44CA8BC4357B47E197A0BACFFFFFFFF01CA200000000000001976A914605770F88D2F9F1A5432F903DFEC78B532A8C6D688AC00000000";
        testConfig.transactionInputBytes = "415C13DA71B173B437F46D9283FBB19EEEC15F1153DA5DD620737F70BE08BB3C00000000A2483045022100C3435528DF9903D71A0A2202A717A3936839769A789D565F4823B3CC1E7C193302204DBC62ADA3EA2253FA854FBABC44A03E7297E1D77ACD640DE78C3132E2018E4D414C57000E636F696E7371756172652E636F6D21023026E4459353C8AE361D4A467C75EFCE28B4CB2E49F44CA8BC4357B47E197A0BBA7521023026E4459353C8AE361D4A467C75EFCE28B4CB2E49F44CA8BC4357B47E197A0BACFFFFFFFF";
        testConfig.transactionOutputIndex = 0;
        testConfig.transactionOutputBytes = "102700000000000017A914679806CF2ABF669C82BC03339E2E2536EC93EAF487";
        testConfig.blockHeight = 556767L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A914679806CF2ABF669C82BC03339E2E2536EC93EAF487";
        testConfig.unlockingScriptBytes = "483045022100C3435528DF9903D71A0A2202A717A3936839769A789D565F4823B3CC1E7C193302204DBC62ADA3EA2253FA854FBABC44A03E7297E1D77ACD640DE78C3132E2018E4D414C57000E636F696E7371756172652E636F6D21023026E4459353C8AE361D4A467C75EFCE28B4CB2E49F44CA8BC4357B47E197A0BBA7521023026E4459353C8AE361D4A467C75EFCE28B4CB2E49F44CA8BC4357B47E197A0BAC";

        // Median Block Time:   1542321079
        // Network Time:        1542328391

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_94B8E61EF05AE9C8379C1CD0CC57F503246AEA1C3330C111944998888FB534C1_0() {
        // NOTE: This transaction uses BITWISE_INVERT, which is disabled on BCH...

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "02000000041806206831C8632AA6B7640B668187167F7803882607B46D6C33C732C536FE383400000003510183FFFFFFFF1806206831C8632AA6B7640B668187167F7803882607B46D6C33C732C536FE38460000000451510195FFFFFFFF1806206831C8632AA6B7640B668187167F7803882607B46D6C33C732C536FE38490000000452510198FFFFFFFF1806206831C8632AA6B7640B668187167F7803882607B46D6C33C732C536FE384A0000000452510199FFFFFFFF01F6540000000000001976A9145FC017074093959A2CE59D1C057E8FC3CDB5805A88AC02770800";
        testConfig.transactionInputBytes = "1806206831C8632AA6B7640B668187167F7803882607B46D6C33C732C536FE383400000003510183FFFFFFFF";
        testConfig.transactionOutputIndex = 52;
        testConfig.transactionOutputBytes = "7C1500000000000017A914AE4E0B89CBB2AB12390BDE0464CA1B73D03E96F687";
        testConfig.blockHeight = 556767L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A914AE4E0B89CBB2AB12390BDE0464CA1B73D03E96F687";
        testConfig.unlockingScriptBytes = "510183";

        // Median Block Time:   1542384261
        // Network Time:        1542390241

        runScripts(testConfig, false);
    }

    @Test
    public void should_verify_transaction_7F34BDF9E62C2E5C9AF8261439007D5BCC9220238CC296638385E8437CA05DBF_0() {
        // NOTE: This transactions has a dirty stack and should not be valid on the ABC Fork, but is valid on Status Quo and Bitcoin SV...

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "0200000001303CB5A0654B4554E3D4B6AE626D3B6514FEE466D8EDE44B136E951F7F2F9702000000001716001479B4BDD742C68413DF9D6ED5B938273F96282AD0FFFFFFFF01DA78CF2F000000001976A9149B959DD18A4D8DA15F0C8DA8D3A3AD16556DF5B288ACC3F6C659";
        testConfig.transactionInputBytes = "303CB5A0654B4554E3D4B6AE626D3B6514FEE466D8EDE44B136E951F7F2F9702000000001716001479B4BDD742C68413DF9D6ED5B938273F96282AD0FFFFFFFF";
        testConfig.transactionOutputIndex = 0;
        testConfig.transactionOutputBytes = "7C79CF2F0000000017A9141B8CCE8D292B94336EE98A02B11279F9A32D007787";
        testConfig.blockHeight = 558220L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A9141B8CCE8D292B94336EE98A02B11279F9A32D007787";
        testConfig.unlockingScriptBytes = "16001479B4BDD742C68413DF9D6ED5B938273F96282AD0";

        // Median Block Time:   1543234497
        // Network Time:        1543240429

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_0C054B865E4CB44746E46BBEF579BF5AD00577F84ED9DAF0733A0E1523006D32_0() {
        // NOTE: This transaction is the first Schnorr signature of the 20190515 HF...

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "01000000018ED4963D2710FBAE533097342DE5BEFFA69B4A0F76C8C2FD984F53B9A85F85A8000000006441BD49BBF18F6EFD604AD8EE21A7C361561618E54B0C59B8F1C442FBBB8255CE9FF36160C0551DD6E1CC6A95BE43D628E6A186A7B8C391F32A57CE27E3AF5A3A9D41210214EE3C4F99BDAF019B03A87E655B63DCD2A1664C6387E2AFB9B5275695ACBB25FEFFFFFF0200000000000000002C6A04010101010F6263685F7363686E6F72725F706C7315017F9FA1E2C8E6C6C7E41AD36868D76310CA6ECB04A3910100000000001976A914D59A2521310F0AAB3C40E399A6D7859CAE3408DA88AC17E40800";
        testConfig.transactionInputBytes = "8ED4963D2710FBAE533097342DE5BEFFA69B4A0F76C8C2FD984F53B9A85F85A8000000006441BD49BBF18F6EFD604AD8EE21A7C361561618E54B0C59B8F1C442FBBB8255CE9FF36160C0551DD6E1CC6A95BE43D628E6A186A7B8C391F32A57CE27E3AF5A3A9D41210214EE3C4F99BDAF019B03A87E655B63DCD2A1664C6387E2AFB9B5275695ACBB25FEFFFFFF";
        testConfig.transactionOutputIndex = 0;
        testConfig.transactionOutputBytes = "91920100000000001976A914B075848D9130E9948C79B7FF363B5FC7378B755F88AC";
        testConfig.blockHeight = 582680L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "76A914B075848D9130E9948C79B7FF363B5FC7378B755F88AC";
        testConfig.unlockingScriptBytes = "41BD49BBF18F6EFD604AD8EE21A7C361561618E54B0C59B8F1C442FBBB8255CE9FF36160C0551DD6E1CC6A95BE43D628E6A186A7B8C391F32A57CE27E3AF5A3A9D41210214EE3C4F99BDAF019B03A87E655B63DCD2A1664C6387E2AFB9B5275695ACBB25";

        // Median Block Time:   1557921789
        // Network Time:        1557927027

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_A618DC10B8A1F9D9A1469B3BB84FC17DA86DF2D51C27E2AA16FA130953840735_0() {
        // NOTE: SigHash Type is multiple bytes in length, but is before STRICTENC and is valid...

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "0100000001162E699CEBB46E6F3FA9B99E82C792F394562CE7E6FDA97980F1866F6CA7F251010000008C493045022100A9379B66C22432585CB2F5E1E85736C69CF5FDC9E1033AD583FC27F0B7C561D802202C7B5D9D92CECA742829FFBE28BA6565FAA8F94556CB091CBC39D2F11D45946700014104650A9A1DEB523F636379EC70C29B3E1E832E314DEA0F791160F3DBA628F4F509360E525318BF7892AF9FFE2F585BF7B264AA31792744EC1885CE17F3B1EF50F3FFFFFFFF0240A5AE02000000001976A914ED2533122FFD7F0724C424599206CCB23E89D6F788AC404B4C00000000001976A914C0AC87C28C943CAEAD3E6D64663449BFC9F0A5CE88AC00000000";
        testConfig.transactionInputBytes = "162E699CEBB46E6F3FA9B99E82C792F394562CE7E6FDA97980F1866F6CA7F251010000008C493045022100A9379B66C22432585CB2F5E1E85736C69CF5FDC9E1033AD583FC27F0B7C561D802202C7B5D9D92CECA742829FFBE28BA6565FAA8F94556CB091CBC39D2F11D45946700014104650A9A1DEB523F636379EC70C29B3E1E832E314DEA0F791160F3DBA628F4F509360E525318BF7892AF9FFE2F585BF7B264AA31792744EC1885CE17F3B1EF50F3FFFFFFFF";
        testConfig.transactionOutputIndex = 1;
        testConfig.transactionOutputBytes = "80F0FA02000000001976A9146482D425DC43FF3890071F13C07C42236E50833888AC";
        testConfig.blockHeight = 135106L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "76A9146482D425DC43FF3890071F13C07C42236E50833888AC";
        testConfig.unlockingScriptBytes = "493045022100A9379B66C22432585CB2F5E1E85736C69CF5FDC9E1033AD583FC27F0B7C561D802202C7B5D9D92CECA742829FFBE28BA6565FAA8F94556CB091CBC39D2F11D45946700014104650A9A1DEB523F636379EC70C29B3E1E832E314DEA0F791160F3DBA628F4F509360E525318BF7892AF9FFE2F585BF7B264AA31792744EC1885CE17F3B1EF50F3";

        // Median Block Time:   1561773176
        // Network Time:        1561783980

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_62B1267DEF9910E2B2F8788B32A442A419CD7945E3341282285FED0BD0C86E46_0() {
        // NOTE: Transaction is not canonical (not yet enabled at blockHeight), but occurs after STRICT_ENC enforcement...

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "010000000374449095C952A491EF64105EB30107FAD740F9C19CA24BE6CE63C68FA91CBED3190000006C493046022100EEF7252B2A3F681D71F876B17723EBE3FB914431126F24B9E6572D8E42F4966D022100B7FA86F9104FA45317C7E146582C935F1099BEE5D43AD60DA71D17660F707A6F412102CCFBB18A71CE437000A09F08E7C8494AB2765B2E7B7F1736F2C2C7876C7B4CECFFFFFFFFC7D05FACB69AF94FE8E6621BE8DC8C3A73516C03B77E0C72A954935D1F205576010000006C493046022100B8F7BD1EC0EB7E8C9D3FD623214CC1D82A873FE3C51B229422234438BD4B7FC802210094514E43A23EAF79D65055F068AD2F765B8B22DC3C81D70C8084242FEFEDE08C4121037EB351AD6365F1F815F68D8F410312C39FFA8A75BADD64891015A2F825330654FFFFFFFF31544ACC63000D565E030CB5F551E3C63E25E603377AC4AAD528C3820685EB93010000006B483045022072F0F4736A19355D2EE23177C9731D5104DFD85D21735E2A9E2F72C4E31CDE0A022100BD3C8EFB185A23AA0B78FFB6B608F9CCF06DEF95C29CF7087106BBD96495D1E9412103D2ACA39612622517E79DA8984E7D090129E40443DDD0F9CD3AAE4872D24D5FA2FFFFFFFF012DA54904000000001976A91435FE90B48C15B8348AEC624C4FDCEFF4E1CA93CF88AC00000000";
        testConfig.transactionInputBytes = "74449095C952A491EF64105EB30107FAD740F9C19CA24BE6CE63C68FA91CBED3190000006C493046022100EEF7252B2A3F681D71F876B17723EBE3FB914431126F24B9E6572D8E42F4966D022100B7FA86F9104FA45317C7E146582C935F1099BEE5D43AD60DA71D17660F707A6F412102CCFBB18A71CE437000A09F08E7C8494AB2765B2E7B7F1736F2C2C7876C7B4CECFFFFFFFF";
        testConfig.transactionOutputIndex = 25;
        testConfig.transactionOutputBytes = "02B95403000000001976A914BC0D924E77FB25188D4F0D1510A25E50E55EB26188AC";
        testConfig.blockHeight = 478631L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "76A914BC0D924E77FB25188D4F0D1510A25E50E55EB26188AC";
        testConfig.unlockingScriptBytes = "493046022100EEF7252B2A3F681D71F876B17723EBE3FB914431126F24B9E6572D8E42F4966D022100B7FA86F9104FA45317C7E146582C935F1099BEE5D43AD60DA71D17660F707A6F412102CCFBB18A71CE437000A09F08E7C8494AB2765B2E7B7F1736F2C2C7876C7B4CEC";

        // Median Block Time:   1562112602
        // Network Time:        1562415438

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_917903A78B7884AF5C772F477C1AF9D78B1E5444FB49A88153937DB5C53A35A5() {
        // Setup
        final TransactionInflater transactionInflater = new TransactionInflater();
        final Transaction transaction = transactionInflater.fromBytes(ByteArray.fromHexString("0200000001D30F579362255AF2257CD5C6198658AC380E23D5FBF281D51845C8D4C335E4A000000000BF483045022100C47E35E77B53B66EC79B64AF8F7029D73714B7B0D8DC6C9BEF60DF90448B6A7702205AD44CD38B1C055B295F05B2BD8CB05C0304C4F7EFC0235C101979D505BA806B41004C7363522102D9E4CC5C8ACA143C72865F25E8C50349BC9EA79F2924CC88A675A52AC23440DA2102D9E4CC5C8ACA143C72865F25E8C50349BC9EA79F2924CC88A675A52AC23440DA52AE67030B0040B2752102D9E4CC5C8ACA143C72865F25E8C50349BC9EA79F2924CC88A675A52AC23440DAAC680B00400001CCC10000000000001976A91466D9E2A3C958C5ACD60C7078670D7BFF49B5646B88AC00000000"));
        final VolatileNetworkTime networkTime = VolatileNetworkTimeWrapper.wrap(ImmutableNetworkTime.fromSeconds(1595337469L));

        final FakeUnspentTransactionOutputContext unspentTransactionOutputContext = new FakeUnspentTransactionOutputContext();
        {
            final Transaction spentTransaction = transactionInflater.fromBytes(ByteArray.fromHexString("0200000002CF586E4F31E01420C3C1CD40E04CA79E2EFE9B4A6CA80BAB0B690922A69F6F17000000006A4730440220425B62D3466BEAF27436369B4627E9CC124820D1316919DD38FAFC0C7E88907602207AA2F228FFDB9ECC2D07500DCA559AD5977AD0CA78A5222387A664C045095577412102D9E4CC5C8ACA143C72865F25E8C50349BC9EA79F2924CC88A675A52AC23440DAFFFFFFFF2F1D2D14C42CA139B3774CB67CE3A2E4C4C249CB2BB0061924EEEBF5A9337E01020000006B483045022100F8FC3B6D8756F24BD5FF7C54A6419A7C2B617A0AAAC47B41A9B7945EDAF7982802205B9B29E3907A31AC6D67A390A92FECBAE1032D43A24922C50F84D9724275635F412102D9E4CC5C8ACA143C72865F25E8C50349BC9EA79F2924CC88A675A52AC23440DAFFFFFFFF0250C300000000000017A914EB3165957A2C7FA8F0829B8C0FB9788B6E707AF18744990000000000001976A91466D9E2A3C958C5ACD60C7078670D7BFF49B5646B88AC00000000"));
            final Sha256Hash spentTransactionBlockHash = Sha256Hash.fromHexString("00000000000000000266C4A80ECFF45BEF40F116EF9A6325185950956C9E7584");
            final Long spentTransactionBlockHeight = 563368L;
            unspentTransactionOutputContext.addTransaction(spentTransaction, spentTransactionBlockHash, spentTransactionBlockHeight, false);
        }

        final FakeMedianBlockTimeContext medianBlockTimeContext = new FakeMedianBlockTimeContext();
        medianBlockTimeContext.setMedianBlockTime(563367L, ImmutableMedianBlockTime.fromSeconds(1546313962L));
        medianBlockTimeContext.setMedianBlockTime(563377L, ImmutableMedianBlockTime.fromSeconds(1546320518L));

        final UpgradeSchedule upgradeSchedule = new FakeUpgradeSchedule(new CoreUpgradeSchedule());
        final TransactionValidatorCore transactionValidator = new TransactionValidatorCore(upgradeSchedule, null, networkTime, null);

        // Action
        final TransactionValidationResult transactionValidationResult = transactionValidator.validateTransaction(563378L, transaction);

        // Assert
        Assert.assertTrue(transactionValidationResult.isValid);
    }

    @Test
    public void should_verify_transaction_AD2EF13304B5324B4C87F3384CB78D6FE302253EE9B2A39651EB5489B056E0C8_0() {

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "010000000234C0754BDB39E40FB8ABD4BBA30E5E7B33392B02A498C8250C29D466477DB8A302000000FD8E0441F02E6DFA949CF4E080AD9ABDD2A72D5B41159CEDFF9A47C33B33A581488879B305C8B6D06471A2A513E67A842CC57A1ECE8E8F39E67D9080E6FBA3ED00F8FCAF412103C7214E08F73FE946F4516C07712C6D56727F7D8FC6B721E89536FDF80694481E4D13015479009C635579820128947F7701207F755779827701219D707C7E030102087E0800000000000000007E0822020000000000000317A9147E01145A7AA97E01207E567A7E01177E557A7E01207E54797E5A797EA97E01877E7C577A7E7C7E5679040000000087646E58797EAA88676EAA8868577AA8537A885679A9537A88567A567A6E7C828C7F75577AA87BABBBAD6D6D5167547A519D5479820128947F7701207F75707C7E030102087E577A7E0822020000000000000317A9147E011457797E01207E567A7E01177E557A7E01207E54797E59797EA97E01877E7C567A7E7C7E5579040000000087646E57797EAA88676EAA8868567AA8537A885579A9537A88716E7C828C7F75567AA87BABBBAC777777682268D40100000000001976A914BD0E269171DFDFC86A337D48B42AE7D847205FDA88AC2222020000000000001976A91485FB199F38DEE3239BE45681515E211B0A71901488AC2103FA4801ECD9DCDCA930654823A22B5B2554384CCF89B5B560D43CD2CB517C4CD74D2301010000009718353858BD08D2D57014A5B1948A7FCB3EFB1284BDF970FA5611C42305B6D0C992651AC89A97AECD0811C1761915A8E2C8F5153D1BDD994A789E6BD86AB71734C0754BDB39E40FB8ABD4BBA30E5E7B33392B02A498C8250C29D466477DB8A30200000086BBAD6D6D5167547A519D5479820128947F7701207F75707C7E030102087E577A7E0822020000000000000317A9147E011457797E01207E567A7E01177E557A7E01207E54797E59797EA97E01877E7C567A7E7C7E5579040000000087646E57797EAA88676EAA8868567AA8537A885579A9537A88716E7C828C7F75567AA87BABBBAC777777682202000000000000FEFFFFFF9612689776C036C342C87DC9C9586E3356CFE35C6C4C7E5EBE453423FBB7FD7CA3110A0041000000004D820114B45F8C6CD3BC1FFD7DECCEE4F3C0A6630614384A20A589E1947EE54F8A124F98BDE8A1D5482D781D839F9DEC0228CE58D1CD479BB4170000000000000000396A04534C50000101044D494E542020CF7CED1C3E2FF3D6620A9CC5D3CB000A5109FD09CE6B0BA86051424A3EDE980D5479009C635579820128947F7701207F755779827701219D707C7E030102087E0800000000000000007E0822020000000000000317A9147E01145A7AA97E01207E567A7E01177E557A7E01207E54797E5A797EA97E01877E7C577A7E7C7E5679040000000087646E58797EAA88676EAA8868577AA8537A885679A9537A88567A567A6E7C828C7F75577AA87BABBBAD6D6D5167547A519D5479820128947F7701207F75707C7E030102087E577A7E0822020000000000000317A9147E011457797E01207E567A7E01177E557A7E01207E54797E59797EA97E01877E7C567A7E7C7E5579040000000087646E57797EAA88676EAA8868567AA8537A885579A9537A88716E7C828C7F75567AA87BABBBAC77777768FEFFFFFFE9580FC30EBD28A87768CE062E197A82940B704BB3A1222F249AF0F19F6C1D4C0300000064416DAE97D8E7D7D47B8641D7023EF6A47BD431EC8844DB68AEC389998046A0BF8D17F51DB26C7DE7CCB2D62B9D387C6C9518D1DFE2B8F70462F2A315997BA7B703412102AA4D8272DF93DC06DF4E7E4361DE8774B5DFA057CCDBB482106164B56BC1CE15FEFFFFFF040000000000000000396A04534C50000101044D494E5420A589E1947EE54F8A124F98BDE8A1D5482D781D839F9DEC0228CE58D1CD479BB4010208000000000000000022020000000000001976A91485FB199F38DEE3239BE45681515E211B0A71901488AC220200000000000017A9141078AD384D12F27EBC08199A7332671309A67A8E8768D40100000000001976A914BD0E269171DFDFC86A337D48B42AE7D847205FDA88ACA3110A00";
        testConfig.transactionInputBytes = "34C0754BDB39E40FB8ABD4BBA30E5E7B33392B02A498C8250C29D466477DB8A302000000FD8E0441F02E6DFA949CF4E080AD9ABDD2A72D5B41159CEDFF9A47C33B33A581488879B305C8B6D06471A2A513E67A842CC57A1ECE8E8F39E67D9080E6FBA3ED00F8FCAF412103C7214E08F73FE946F4516C07712C6D56727F7D8FC6B721E89536FDF80694481E4D13015479009C635579820128947F7701207F755779827701219D707C7E030102087E0800000000000000007E0822020000000000000317A9147E01145A7AA97E01207E567A7E01177E557A7E01207E54797E5A797EA97E01877E7C577A7E7C7E5679040000000087646E58797EAA88676EAA8868577AA8537A885679A9537A88567A567A6E7C828C7F75577AA87BABBBAD6D6D5167547A519D5479820128947F7701207F75707C7E030102087E577A7E0822020000000000000317A9147E011457797E01207E567A7E01177E557A7E01207E54797E59797EA97E01877E7C567A7E7C7E5579040000000087646E57797EAA88676EAA8868567AA8537A885579A9537A88716E7C828C7F75567AA87BABBBAC777777682268D40100000000001976A914BD0E269171DFDFC86A337D48B42AE7D847205FDA88AC2222020000000000001976A91485FB199F38DEE3239BE45681515E211B0A71901488AC2103FA4801ECD9DCDCA930654823A22B5B2554384CCF89B5B560D43CD2CB517C4CD74D2301010000009718353858BD08D2D57014A5B1948A7FCB3EFB1284BDF970FA5611C42305B6D0C992651AC89A97AECD0811C1761915A8E2C8F5153D1BDD994A789E6BD86AB71734C0754BDB39E40FB8ABD4BBA30E5E7B33392B02A498C8250C29D466477DB8A30200000086BBAD6D6D5167547A519D5479820128947F7701207F75707C7E030102087E577A7E0822020000000000000317A9147E011457797E01207E567A7E01177E557A7E01207E54797E59797EA97E01877E7C567A7E7C7E5579040000000087646E57797EAA88676EAA8868567AA8537A885579A9537A88716E7C828C7F75567AA87BABBBAC777777682202000000000000FEFFFFFF9612689776C036C342C87DC9C9586E3356CFE35C6C4C7E5EBE453423FBB7FD7CA3110A0041000000004D820114B45F8C6CD3BC1FFD7DECCEE4F3C0A6630614384A20A589E1947EE54F8A124F98BDE8A1D5482D781D839F9DEC0228CE58D1CD479BB4170000000000000000396A04534C50000101044D494E542020CF7CED1C3E2FF3D6620A9CC5D3CB000A5109FD09CE6B0BA86051424A3EDE980D5479009C635579820128947F7701207F755779827701219D707C7E030102087E0800000000000000007E0822020000000000000317A9147E01145A7AA97E01207E567A7E01177E557A7E01207E54797E5A797EA97E01877E7C577A7E7C7E5679040000000087646E58797EAA88676EAA8868577AA8537A885679A9537A88567A567A6E7C828C7F75577AA87BABBBAD6D6D5167547A519D5479820128947F7701207F75707C7E030102087E577A7E0822020000000000000317A9147E011457797E01207E567A7E01177E557A7E01207E54797E59797EA97E01877E7C567A7E7C7E5579040000000087646E57797EAA88676EAA8868567AA8537A885579A9537A88716E7C828C7F75567AA87BABBBAC77777768FEFFFFFF";
        testConfig.transactionOutputIndex = 2;
        testConfig.transactionOutputBytes = "220200000000000017A914AEE083B277212B73077D6F5EB9F40A0AE6692ED287";
        testConfig.blockHeight = 659876L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A914AEE083B277212B73077D6F5EB9F40A0AE6692ED287";
        testConfig.unlockingScriptBytes = "41F02E6DFA949CF4E080AD9ABDD2A72D5B41159CEDFF9A47C33B33A581488879B305C8B6D06471A2A513E67A842CC57A1ECE8E8F39E67D9080E6FBA3ED00F8FCAF412103C7214E08F73FE946F4516C07712C6D56727F7D8FC6B721E89536FDF80694481E4D13015479009C635579820128947F7701207F755779827701219D707C7E030102087E0800000000000000007E0822020000000000000317A9147E01145A7AA97E01207E567A7E01177E557A7E01207E54797E5A797EA97E01877E7C577A7E7C7E5679040000000087646E58797EAA88676EAA8868577AA8537A885679A9537A88567A567A6E7C828C7F75577AA87BABBBAD6D6D5167547A519D5479820128947F7701207F75707C7E030102087E577A7E0822020000000000000317A9147E011457797E01207E567A7E01177E557A7E01207E54797E59797EA97E01877E7C567A7E7C7E5579040000000087646E57797EAA88676EAA8868567AA8537A885579A9537A88716E7C828C7F75567AA87BABBBAC777777682268D40100000000001976A914BD0E269171DFDFC86A337D48B42AE7D847205FDA88AC2222020000000000001976A91485FB199F38DEE3239BE45681515E211B0A71901488AC2103FA4801ECD9DCDCA930654823A22B5B2554384CCF89B5B560D43CD2CB517C4CD74D2301010000009718353858BD08D2D57014A5B1948A7FCB3EFB1284BDF970FA5611C42305B6D0C992651AC89A97AECD0811C1761915A8E2C8F5153D1BDD994A789E6BD86AB71734C0754BDB39E40FB8ABD4BBA30E5E7B33392B02A498C8250C29D466477DB8A30200000086BBAD6D6D5167547A519D5479820128947F7701207F75707C7E030102087E577A7E0822020000000000000317A9147E011457797E01207E567A7E01177E557A7E01207E54797E59797EA97E01877E7C567A7E7C7E5579040000000087646E57797EAA88676EAA8868567AA8537A885579A9537A88716E7C828C7F75567AA87BABBBAC777777682202000000000000FEFFFFFF9612689776C036C342C87DC9C9586E3356CFE35C6C4C7E5EBE453423FBB7FD7CA3110A0041000000004D820114B45F8C6CD3BC1FFD7DECCEE4F3C0A6630614384A20A589E1947EE54F8A124F98BDE8A1D5482D781D839F9DEC0228CE58D1CD479BB4170000000000000000396A04534C50000101044D494E542020CF7CED1C3E2FF3D6620A9CC5D3CB000A5109FD09CE6B0BA86051424A3EDE980D5479009C635579820128947F7701207F755779827701219D707C7E030102087E0800000000000000007E0822020000000000000317A9147E01145A7AA97E01207E567A7E01177E557A7E01207E54797E5A797EA97E01877E7C577A7E7C7E5679040000000087646E58797EAA88676EAA8868577AA8537A885679A9537A88567A567A6E7C828C7F75577AA87BABBBAD6D6D5167547A519D5479820128947F7701207F75707C7E030102087E577A7E0822020000000000000317A9147E011457797E01207E567A7E01177E557A7E01207E54797E59797EA97E01877E7C567A7E7C7E5579040000000087646E57797EAA88676EAA8868567AA8537A885579A9537A88716E7C828C7F75567AA87BABBBAC77777768";

        // Median Block Time:   1604366422
        // Network Time:        1604381153

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_testnet_transaction_81F488070C4215DD7D1B47734EAE523896297DEA9E3E08D0D368E84AAB9FD7B6_0() {
        final TestNetUpgradeSchedule upgradeSchedule = new TestNetUpgradeSchedule();

        final HistoricTransactionsTests.TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "02000000030D4817464CE572E859074B0A638CD9647C6DCB87A300FBFE40B865AAB5DE134B010000006B483045022100A446F825B8CD6480D11E80E9B720B2F934327F540FFC3C0A6DE0CA171A1D4A540220054207EEF05062E430B93C736F9D7BC8F071483B09E15B43B9EEE875006F7A3B012103A589968481DC6FF8BA5AF1E3FDF5721C49D9336EED6D79302A921D8360D10747FFFFFFFFE13A3B220B7ED7D0CE1757DD6F3CB097489B4605D3B87F7F333A4F3ACA572088010000006B483045022100EA35689C567D6D0107B581DF02832FBA7DAD4C5C8FC58C94AABA84E8251F06B402205E4CE658FE2404ABA3E17E29EB8324D6E38D2F227FA61FEFA67121FDE44A1BAD01210369D2238BD50F291691F9E15A6CC39209EDE21AAF41F1534132B44CAE7F5CC0B5FFFFFFFFF2D2622A1A7A0C8A698F8B8FA4F0B016C012C8A534FF251B235EC1F9D01331B7010000006A4730440220283A2E7448865E9357406F2032D7D12178AB33FF91029A9AD9B5CBEB5BD9349B022058B6B5794478DDA17FC81E9EFE518158A82DB39E59476DA6D8D353AC54454C04012102840DBC78D1C53764BFBDBB128C3B4C1922E2EAC921D65F6B3C51694F09DF95FFFFFFFFFF02404B4C00000000001976A914AC19D3FD17710E6B9A331022FE92C693FDF6659588AC5FE31600000000001976A914A82DF617258ECC8877DE0E969439A08ABE2357D788AC00000000";
        testConfig.transactionInputBytes = "0D4817464CE572E859074B0A638CD9647C6DCB87A300FBFE40B865AAB5DE134B010000006B483045022100A446F825B8CD6480D11E80E9B720B2F934327F540FFC3C0A6DE0CA171A1D4A540220054207EEF05062E430B93C736F9D7BC8F071483B09E15B43B9EEE875006F7A3B012103A589968481DC6FF8BA5AF1E3FDF5721C49D9336EED6D79302A921D8360D10747FFFFFFFF";
        testConfig.transactionOutputIndex = 1;
        testConfig.transactionOutputBytes = "40E13300000000001976A91453EA30DF8506AA0E560678F5FA989A8051F9E71D88AC";
        testConfig.blockHeight = 1155875L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "76A91453EA30DF8506AA0E560678F5FA989A8051F9E71D88AC";
        testConfig.unlockingScriptBytes = "483045022100A446F825B8CD6480D11E80E9B720B2F934327F540FFC3C0A6DE0CA171A1D4A540220054207EEF05062E430B93C736F9D7BC8F071483B09E15B43B9EEE875006F7A3B012103A589968481DC6FF8BA5AF1E3FDF5721C49D9336EED6D79302A921D8360D10747";
        testConfig.medianBlockTime = 1501589615L;

        // Network Time: 1608530831

        HistoricTransactionsTests.runScripts(testConfig, upgradeSchedule);
    }

    @Test
    public void should_verify_testnet_transaction_B3FA07C78A2EC7CEF75E0FD558FD60756287B31B9AC810F6B5A06D9FACE060BD_0() {
        final TestNetUpgradeSchedule upgradeSchedule = new TestNetUpgradeSchedule();

        final HistoricTransactionsTests.TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "0100000001F268EE57BC5C2D7191709C34C3D119F36494340DA178C4EFFCCB9F6BB7E1C7E80000000023220020A8C4BBE5EFA86519468CB1188565E481860FD8DDCC1F5242AD737E72230D0434FFFFFFFF01C37352000000000017A9141516811D888D572AE963E048D17CC76C7DFB431D8700000000";
        testConfig.transactionInputBytes = "F268EE57BC5C2D7191709C34C3D119F36494340DA178C4EFFCCB9F6BB7E1C7E80000000023220020A8C4BBE5EFA86519468CB1188565E481860FD8DDCC1F5242AD737E72230D0434FFFFFFFF";
        testConfig.transactionOutputIndex = 1;
        testConfig.transactionOutputBytes = "D39A52000000000017A9141FBA0A1055D1035F798F83D08E7DD3383C0378AE87";
        testConfig.blockHeight = 1304881L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A9141FBA0A1055D1035F798F83D08E7DD3383C0378AE87";
        testConfig.unlockingScriptBytes = "220020A8C4BBE5EFA86519468CB1188565E481860FD8DDCC1F5242AD737E72230D0434";
        testConfig.medianBlockTime = 1558462233L;

        // Network Time: 1608674729

        HistoricTransactionsTests.runScripts(testConfig, upgradeSchedule);
    }

    @Test
    public void should_verify_transaction_2D875EA603E31E20405468BC935CE9D3966509BCBF0FBE3AF098A69D46C82220_0() {

        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "0100000002A6E7D0941D4BCA48937B27B1CF6C0C9AB56FA9A7BB1ECB006338CD81C46A98D101000000FDD3032103042A18AD7795626FD5AF69439BB7CB2DC7DF4BAEE94F043A15EC8D47AA215C3D463044022100DA6F8B355DD32AB5E676979C5C1685CEB4BA7E6777E3417FAC10BC99EF3E9104021F61CC89483AB20D8A43CFEE941D9BA1A27F5092F57937B63A98F73EAD50AFB04C9E010000003F79CF2D319226BE3AC9CC087166A1DCDA8C6A3079CB287F10A973716D9A731F752ADAD0A7B9CECA853768AEBB6965ECA126A62965F698A0C1BC43D83DB632ADA6E7D0941D4BCA48937B27B1CF6C0C9AB56FA9A7BB1ECB006338CD81C46A98D10100000001AC2202000000000000FFFFFFFF1CAC59A66F601432113D1D073302E61C406A0B04DA958B719CE337B1BB1527480000000041000000140E37DA75E391ED966DA40474FE3F3B433E61125914A3852167750AC15790C56C373E6E55AE06373D1814517C1176CCCE58DAD927306854DBC5CA6E3B5CD414EDBE8B6C49A510D2EDA98295B63F39B233FB98EA14055D9D26D0C77EB475DD51060F4177EF9C80C7841461784E6BCAFD696E1DAF8C5C6227E463C813B1FF144D20E46A092E5AABD49434C2614FA62EA73C845214BE35DD3EE8AB1B00A178B25F37FB8C65EF58A6A01406B907C1BAAC5005AE2BF38D7845A0AC68989B5214788F620E75354DF40D8B9A10DB7DE8234E16256114000000000000000000000000000000000000000004000080202C9794D66080AA65AE44071D181074F333B6EFFA7F8ACF379BEFEC8F751572189E7EE5E75F5D0505181121E6BE040000C0202C54202218201643C5E5B97147E7A85A4446DBCC944650C1341B5EBF36C915158E4BE4E75FADFC0418A49B3C5F4D7C010401000000147B1FDF0F52FCDB82877C0EA485963F29872F55C1376A04534C500001010453454E4420BB29E8A651A6CB0AC067B8D9B2F64C46EEB7921AB8A9B874A19703A910A370C70800000000000004006B6B6B20F71710A2601CD95D08DE60F53E9AA1442616170C5BB39A0100000000000000007C7E7EAA7601187F77817600A2690330F709A1697C7E7EAA7601187F77817600A2690330F709A169547F7581906C81975B797852967C7252977A7EA97852967C7252977A7EA97852967C7252977A7EA97852967C7252977A7EA97852967C7252977A7EA97852967C7252977A7EA97852967C7252977A7EA97852967C7252977A7EA97852967C7252977A7EA97C5297917A7EA96C8801405980BC6C012F7FBC517F77817654967D945780BC01007E7C5780587EBC01007E7E7E7E0C22020000000000001976A9147B2488AC22020000000000001976A9140E37DA75E391ED966DA40474FE3F3B433E61125988AC7E7E7EAA7801767F7701207F7588A86F7BBB7501417E7CABACFFFFFFFF5296BDABFA90373B1B86F45D9B27E9CAFF33430728A747F088B36904CA6023860A0000006B48304502210090A8D9D1E32F442E465438D1AC2D5B15272756FA3528DEB7031D360F7F94FE9402203FC25DAAF6ED74209AAA2829F9458561612470883F1DADED21254F60626A06EF412103C1DD0A5996FB5D339EBB9F369C817FAF1A919BEB285D4A102CC049C4AAF1C9BAFFFFFFFF030000000000000000406A04534C500001010453454E4420BB29E8A651A6CB0AC067B8D9B2F64C46EEB7921AB8A9B874A19703A910A370C708000000000000030008000000000000010022020000000000001976A9140E37DA75E391ED966DA40474FE3F3B433E61125988AC22020000000000001976A9140E37DA75E391ED966DA40474FE3F3B433E61125988AC00000000";
        testConfig.transactionInputBytes = "A6E7D0941D4BCA48937B27B1CF6C0C9AB56FA9A7BB1ECB006338CD81C46A98D101000000FDD3032103042A18AD7795626FD5AF69439BB7CB2DC7DF4BAEE94F043A15EC8D47AA215C3D463044022100DA6F8B355DD32AB5E676979C5C1685CEB4BA7E6777E3417FAC10BC99EF3E9104021F61CC89483AB20D8A43CFEE941D9BA1A27F5092F57937B63A98F73EAD50AFB04C9E010000003F79CF2D319226BE3AC9CC087166A1DCDA8C6A3079CB287F10A973716D9A731F752ADAD0A7B9CECA853768AEBB6965ECA126A62965F698A0C1BC43D83DB632ADA6E7D0941D4BCA48937B27B1CF6C0C9AB56FA9A7BB1ECB006338CD81C46A98D10100000001AC2202000000000000FFFFFFFF1CAC59A66F601432113D1D073302E61C406A0B04DA958B719CE337B1BB1527480000000041000000140E37DA75E391ED966DA40474FE3F3B433E61125914A3852167750AC15790C56C373E6E55AE06373D1814517C1176CCCE58DAD927306854DBC5CA6E3B5CD414EDBE8B6C49A510D2EDA98295B63F39B233FB98EA14055D9D26D0C77EB475DD51060F4177EF9C80C7841461784E6BCAFD696E1DAF8C5C6227E463C813B1FF144D20E46A092E5AABD49434C2614FA62EA73C845214BE35DD3EE8AB1B00A178B25F37FB8C65EF58A6A01406B907C1BAAC5005AE2BF38D7845A0AC68989B5214788F620E75354DF40D8B9A10DB7DE8234E16256114000000000000000000000000000000000000000004000080202C9794D66080AA65AE44071D181074F333B6EFFA7F8ACF379BEFEC8F751572189E7EE5E75F5D0505181121E6BE040000C0202C54202218201643C5E5B97147E7A85A4446DBCC944650C1341B5EBF36C915158E4BE4E75FADFC0418A49B3C5F4D7C010401000000147B1FDF0F52FCDB82877C0EA485963F29872F55C1376A04534C500001010453454E4420BB29E8A651A6CB0AC067B8D9B2F64C46EEB7921AB8A9B874A19703A910A370C70800000000000004006B6B6B20F71710A2601CD95D08DE60F53E9AA1442616170C5BB39A0100000000000000007C7E7EAA7601187F77817600A2690330F709A1697C7E7EAA7601187F77817600A2690330F709A169547F7581906C81975B797852967C7252977A7EA97852967C7252977A7EA97852967C7252977A7EA97852967C7252977A7EA97852967C7252977A7EA97852967C7252977A7EA97852967C7252977A7EA97852967C7252977A7EA97852967C7252977A7EA97C5297917A7EA96C8801405980BC6C012F7FBC517F77817654967D945780BC01007E7C5780587EBC01007E7E7E7E0C22020000000000001976A9147B2488AC22020000000000001976A9140E37DA75E391ED966DA40474FE3F3B433E61125988AC7E7E7EAA7801767F7701207F7588A86F7BBB7501417E7CABACFFFFFFFF";
        testConfig.transactionOutputIndex = 0;
        testConfig.transactionOutputBytes = "220200000000000017A91484A932C5206A3160EC2D26DB0DCCBF9DFAF89FC587";
        testConfig.blockHeight = 667610L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A91484A932C5206A3160EC2D26DB0DCCBF9DFAF89FC587";
        testConfig.unlockingScriptBytes = "2103042A18AD7795626FD5AF69439BB7CB2DC7DF4BAEE94F043A15EC8D47AA215C3D463044022100DA6F8B355DD32AB5E676979C5C1685CEB4BA7E6777E3417FAC10BC99EF3E9104021F61CC89483AB20D8A43CFEE941D9BA1A27F5092F57937B63A98F73EAD50AFB04C9E010000003F79CF2D319226BE3AC9CC087166A1DCDA8C6A3079CB287F10A973716D9A731F752ADAD0A7B9CECA853768AEBB6965ECA126A62965F698A0C1BC43D83DB632ADA6E7D0941D4BCA48937B27B1CF6C0C9AB56FA9A7BB1ECB006338CD81C46A98D10100000001AC2202000000000000FFFFFFFF1CAC59A66F601432113D1D073302E61C406A0B04DA958B719CE337B1BB1527480000000041000000140E37DA75E391ED966DA40474FE3F3B433E61125914A3852167750AC15790C56C373E6E55AE06373D1814517C1176CCCE58DAD927306854DBC5CA6E3B5CD414EDBE8B6C49A510D2EDA98295B63F39B233FB98EA14055D9D26D0C77EB475DD51060F4177EF9C80C7841461784E6BCAFD696E1DAF8C5C6227E463C813B1FF144D20E46A092E5AABD49434C2614FA62EA73C845214BE35DD3EE8AB1B00A178B25F37FB8C65EF58A6A01406B907C1BAAC5005AE2BF38D7845A0AC68989B5214788F620E75354DF40D8B9A10DB7DE8234E16256114000000000000000000000000000000000000000004000080202C9794D66080AA65AE44071D181074F333B6EFFA7F8ACF379BEFEC8F751572189E7EE5E75F5D0505181121E6BE040000C0202C54202218201643C5E5B97147E7A85A4446DBCC944650C1341B5EBF36C915158E4BE4E75FADFC0418A49B3C5F4D7C010401000000147B1FDF0F52FCDB82877C0EA485963F29872F55C1376A04534C500001010453454E4420BB29E8A651A6CB0AC067B8D9B2F64C46EEB7921AB8A9B874A19703A910A370C70800000000000004006B6B6B20F71710A2601CD95D08DE60F53E9AA1442616170C5BB39A0100000000000000007C7E7EAA7601187F77817600A2690330F709A1697C7E7EAA7601187F77817600A2690330F709A169547F7581906C81975B797852967C7252977A7EA97852967C7252977A7EA97852967C7252977A7EA97852967C7252977A7EA97852967C7252977A7EA97852967C7252977A7EA97852967C7252977A7EA97852967C7252977A7EA97852967C7252977A7EA97C5297917A7EA96C8801405980BC6C012F7FBC517F77817654967D945780BC01007E7C5780587EBC01007E7E7E7E0C22020000000000001976A9147B2488AC22020000000000001976A9140E37DA75E391ED966DA40474FE3F3B433E61125988AC7E7E7EAA7801767F7701207F7588A86F7BBB7501417E7CABAC";

        // Median Block Time:   1609029152
        // Network Time:        1609048366

        HistoricTransactionsTests.runScripts(testConfig);
    }

    @Test
    public void should_verify_transaction_1404153F7DEB13815233FE27C5F0810CC7D7832949D3102080203818D0607A58_0() {
        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "0100000001B2CB66B84B20FEBF61C035BA62F24F8F169CF1225A7BE8B814193AED9E4D3ABD000000004220B2CB66B84B20FEBF61C035BA62F24F8F169CF1225A7BE8B814193AED9E4D3ABD2000C8887463756874637568746375687463756874637568746375687463756851000000000193CD97000000000017A914DC4683722DBDEDB04F3A45886020C573BA05DDC78700000000";
        testConfig.transactionInputBytes = "B2CB66B84B20FEBF61C035BA62F24F8F169CF1225A7BE8B814193AED9E4D3ABD000000004220B2CB66B84B20FEBF61C035BA62F24F8F169CF1225A7BE8B814193AED9E4D3ABD2000C888746375687463756874637568746375687463756874637568746375685100000000";
        testConfig.transactionOutputIndex = 0;
        testConfig.transactionOutputBytes = "87CF97000000000017A9146A712D1B560D118C60E66F709DB740744BD2042B87";
        testConfig.blockHeight = 70638L;
        testConfig.medianBlockTime = 1637694332L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A9146A712D1B560D118C60E66F709DB740744BD2042B87";
        testConfig.unlockingScriptBytes = "20B2CB66B84B20FEBF61C035BA62F24F8F169CF1225A7BE8B814193AED9E4D3ABD2000C8887463756874637568746375687463756874637568746375687463756851";

        // Median Block Time:   1637694332
        // Network Time:        1637988507

        HistoricTransactionsTests.runScripts(testConfig, new TestNet4UpgradeSchedule());
    }

    @Test
    public void should_verify_transaction_11CB5E8E60B8536AC81DF6A962A6C1E9AACD987A5CBB15A7BD57230B74AE6B5E_0() {
        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "010000000186CC38934771FED3457F1C31C8E063667E8244EA9666EA9E58EF1614F41663020000000022002000CB8874637568746375687463756874637568746375687463756874637568510000000001C3C597000000000017A914DC4683722DBDEDB04F3A45886020C573BA05DDC78700000000";
        testConfig.transactionInputBytes = "86CC38934771FED3457F1C31C8E063667E8244EA9666EA9E58EF1614F41663020000000022002000CB88746375687463756874637568746375687463756874637568746375685100000000";
        testConfig.transactionOutputIndex = 0;
        testConfig.transactionOutputBytes = "B7C797000000000017A914AD9516CD99B26ADC8481289C0EA112D6D485CB6987";
        testConfig.blockHeight = 70638L;
        testConfig.medianBlockTime = 1637694332L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A914AD9516CD99B26ADC8481289C0EA112D6D485CB6987";
        testConfig.unlockingScriptBytes = "002000CB887463756874637568746375687463756874637568746375687463756851";

        // Median Block Time:   1637694332
        // Network Time:        1637988507

        HistoricTransactionsTests.runScripts(testConfig, new TestNet4UpgradeSchedule());
    }

    @Test
    public void should_verify_transaction_179C597CD77210F68081CF430AE8B406E2B26EE31DCE11D8F1EBF88879EDE3BE_0() {
        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "010000000191455607F510B0BB6F60051AB74F55FDF080146F3440EA62DDB3C8AE349721C70000000037003506668E97BAF2430340E281950880A5FFFFFFFFFFFF88C08874637568746375687463756874637568746375687463756874637568510000000001583E0F000000000017A914DC4683722DBDEDB04F3A45886020C573BA05DDC78700000000";
        testConfig.transactionInputBytes = "91455607F510B0BB6F60051AB74F55FDF080146F3440EA62DDB3C8AE349721C70000000037003506668E97BAF2430340E281950880A5FFFFFFFFFFFF88C088746375687463756874637568746375687463756874637568746375685100000000";
        testConfig.transactionOutputIndex = 0;
        testConfig.transactionOutputBytes = "4C400F000000000017A914E1C1FB04286B1FA8CF6701E3B975B88A173A196C87";
        testConfig.blockHeight = 70638L;
        testConfig.medianBlockTime = 1637694332L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A914E1C1FB04286B1FA8CF6701E3B975B88A173A196C87";
        testConfig.unlockingScriptBytes = "003506668E97BAF2430340E281950880A5FFFFFFFFFFFF88C0887463756874637568746375687463756874637568746375687463756851";

        // Median Block Time:   1637694332
        // Network Time:        1637988507

        HistoricTransactionsTests.runScripts(testConfig, new TestNet4UpgradeSchedule());
    }

    @Test
    public void should_verify_transaction_50E63BD6C90972B06FC171540903147549E5912E54A275971AA453884D6E21F9_0() {
        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "0200000002833B6C4E1095FF7A7999AE5D00B60DEF0C14824617ABCC01D5AFB0FD541BA26D010000006A473044022005E476612E0BED4C43173F657B0ABF9EB00013C1D1A7CA5DE649648E97972BCA02203C4A89B52B2ED966EDA6B10B8D5E17A1A6CC956B79317C3761F0A98C0EB556176121022EEBF1895D911E62C184A47C775CE8FE11FB42E38FD9C8D5F055A60620A25738FFFFFFFF43C1044127E1274181E7458C70B02D5C75B49B31A337D85703D56480345CD2CC000000006A47304402207DBAF79686114EC8649B9C5D3FCE16984E782C4D350FF47E3BB95421E6E9895A0220223BD048D4AE63018DB930864A71E871B00BD92444F8D4834CB2BF5425B0623D612102ABAAD90841057DDB1ED929608B536535B0CD8A18BA0A90DBA66BA7B1C1F7B4EAFFFFFFFF03102700000000000054EF43C1044127E1274181E7458C70B02D5C75B49B31A337D85703D56480345CD2CC720F4D7561686168616861686168616821FFFFFFFFFFFFFFFF7F76A9140A373CAF0AB3C2B46CD05625B8D545C295B93D7A88ACA0860100000000004CEFBC54B7422A5DFE5188E4AC2D80661452C5BC59F7F0B8DBEA98C0BEEECB49F961720B4920616D2043616C696E21FE8ED73E0D76A914FD68D2C87F0DC1799E51657D32EFB9AA367D161E88ACA8DAB12F000000001976A914746598C6FFCBEDF86A1F3E2C695CED708BEA8C1588AC00000000";
        testConfig.transactionInputBytes = "833B6C4E1095FF7A7999AE5D00B60DEF0C14824617ABCC01D5AFB0FD541BA26D010000006A473044022005E476612E0BED4C43173F657B0ABF9EB00013C1D1A7CA5DE649648E97972BCA02203C4A89B52B2ED966EDA6B10B8D5E17A1A6CC956B79317C3761F0A98C0EB556176121022EEBF1895D911E62C184A47C775CE8FE11FB42E38FD9C8D5F055A60620A25738FFFFFFFF";
        testConfig.transactionOutputIndex = 0;
        testConfig.transactionOutputBytes = "A07CB32F000000001976A914FD68D2C87F0DC1799E51657D32EFB9AA367D161E88AC";
        testConfig.blockHeight = 111744L;
        testConfig.medianBlockTime = 1662377313L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "76A914FD68D2C87F0DC1799E51657D32EFB9AA367D161E88AC";
        testConfig.unlockingScriptBytes = "473044022005E476612E0BED4C43173F657B0ABF9EB00013C1D1A7CA5DE649648E97972BCA02203C4A89B52B2ED966EDA6B10B8D5E17A1A6CC956B79317C3761F0A98C0EB556176121022EEBF1895D911E62C184A47C775CE8FE11FB42E38FD9C8D5F055A60620A25738";

        final TransactionOutputInflater transactionOutputInflater = new TransactionOutputInflater();
        final MutableList<TransactionOutput> previousOutputs = new MutableArrayList<>();
        previousOutputs.add(transactionOutputInflater.fromBytes(1, ByteArray.fromHexString("A07CB32F000000001976A914FD68D2C87F0DC1799E51657D32EFB9AA367D161E88AC")));
        previousOutputs.add(transactionOutputInflater.fromBytes(0, ByteArray.fromHexString("401F0000000000004FEFBC54B7422A5DFE5188E4AC2D80661452C5BC59F7F0B8DBEA98C0BEEECB49F961720E48656C6C6F20776F726C64212021FE8ED73E0D76A9140A373CAF0AB3C2B46CD05625B8D545C295B93D7A88AC")));

        // Median Block Time:   1662377313
        // Network Time:        1668393241

        Assert.assertTrue(HistoricTransactionsTests.runScripts(testConfig, previousOutputs, new ChipNetUpgradeSchedule() {{
            _activationBlockTimes[UpgradeTime.HF20230515_ACTIVATION_TIME.value] = 1662250000L;
        }}));
    }

    // C97ECA8933B0D7175D9428EB8A4193CE3082356013AE44866067A6A53F27C0A0: {"inputBytes":"C431348339823699D6F0FE47F8D66EC79C90A1AEF368DF2599CFDFC2B2586E9F010000001F1E5102E80351B2757C00A26900CD02A914C1A97E01877E88C0C67C9400CCA101000000","medianBlockTime":1654902233,"blockHeight":99284,"inputIndex":0,"unlockingScriptBytes":"1E5102E80351B2757C00A26900CD02A914C1A97E01877E88C0C67C9400CCA1","errorMessage":"Transaction failed to unlock inputs.","previousOutputs":["102700000000000017A9143D416D6B3B4F59826661D868BA4FD6F62FDE537787"],"previousOutputBytes":"102700000000000017A9143D416D6B3B4F59826661D868BA4FD6F62FDE537787","transactionBytes":"0200000001C431348339823699D6F0FE47F8D66EC79C90A1AEF368DF2599CFDFC2B2586E9F010000001F1E5102E80351B2757C00A26900CD02A914C1A97E01877E88C0C67C9400CCA101000000022A2300000000000017A9143D416D6B3B4F59826661D868BA4FD6F62FDE53778702030000000000001976A91484F58143428D2441D8BC18D1805C6C3F93B2592A88ACD3830100","transactionHash":"C97ECA8933B0D7175D9428EB8A4193CE3082356013AE44866067A6A53F27C0A0","lockingScriptBytes":"17A9143D416D6B3B4F59826661D868BA4FD6F62FDE537787","networkTime":1668461850}
    @Test
    public void should_verify_transaction_C97ECA8933B0D7175D9428EB8A4193CE3082356013AE44866067A6A53F27C0A0_0() {
        final TestConfig testConfig = new TestConfig();
        testConfig.transactionBytes = "0200000001C431348339823699D6F0FE47F8D66EC79C90A1AEF368DF2599CFDFC2B2586E9F010000001F1E5102E80351B2757C00A26900CD02A914C1A97E01877E88C0C67C9400CCA101000000022A2300000000000017A9143D416D6B3B4F59826661D868BA4FD6F62FDE53778702030000000000001976A91484F58143428D2441D8BC18D1805C6C3F93B2592A88ACD3830100";
        testConfig.transactionInputBytes = "C431348339823699D6F0FE47F8D66EC79C90A1AEF368DF2599CFDFC2B2586E9F010000001F1E5102E80351B2757C00A26900CD02A914C1A97E01877E88C0C67C9400CCA101000000";
        testConfig.transactionOutputIndex = 0;
        testConfig.transactionOutputBytes = "102700000000000017A9143D416D6B3B4F59826661D868BA4FD6F62FDE537787";
        testConfig.blockHeight = 99284L;
        testConfig.medianBlockTime = 1654902233L;
        testConfig.transactionInputIndex = 0;
        testConfig.lockingScriptBytes = "A9143D416D6B3B4F59826661D868BA4FD6F62FDE537787";
        testConfig.unlockingScriptBytes = "1E5102E80351B2757C00A26900CD02A914C1A97E01877E88C0C67C9400CCA1";

        final TransactionOutputInflater transactionOutputInflater = new TransactionOutputInflater();
        final MutableList<TransactionOutput> previousOutputs = new MutableArrayList<>();
        previousOutputs.add(transactionOutputInflater.fromBytes(1, ByteArray.fromHexString("102700000000000017A9143D416D6B3B4F59826661D868BA4FD6F62FDE537787")));

        // Median Block Time:   1654902233
        // Network Time:        1668461850

        Assert.assertTrue(HistoricTransactionsTests.runScripts(testConfig, previousOutputs, new ChipNetUpgradeSchedule() {{
            _activationBlockTimes[UpgradeTime.HF20230515_ACTIVATION_TIME.value] = 1662250000L;
        }}));
    }
}
